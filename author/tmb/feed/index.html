<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Portcullis Labs &#187; TMB</title>
	<atom:link href="https://labs.portcullis.co.uk/author/tmb/feed/" rel="self" type="application/rss+xml" />
	<link>https://labs.portcullis.co.uk</link>
	<description>Research and Development</description>
	<language>en-US</language>
		<sy:updatePeriod>hourly</sy:updatePeriod>
		<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=3.8.5</generator>
	<item>
		<title>Security Engineering &#8211; A manifesto for defensive security</title>
		<link>https://labs.portcullis.co.uk/presentations/security-engineering-a-manifesto-for-defensive-security/</link>
		<comments>https://labs.portcullis.co.uk/presentations/security-engineering-a-manifesto-for-defensive-security/#comments</comments>
		<pubDate>Fri, 28 Jun 2019 06:27:47 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Presentations]]></category>
		<category><![CDATA[C-Suite]]></category>
		<category><![CDATA[conference]]></category>
		<category><![CDATA[CRQ]]></category>
		<category><![CDATA[cyber risk quantification]]></category>
		<category><![CDATA[devops]]></category>
		<category><![CDATA[devsecops]]></category>
		<category><![CDATA[hardening]]></category>
		<category><![CDATA[infradev]]></category>
		<category><![CDATA[orchestration]]></category>
		<category><![CDATA[risk]]></category>
		<category><![CDATA[seceng]]></category>
		<category><![CDATA[service providers]]></category>
		<category><![CDATA[SnoopCon]]></category>
		<category><![CDATA[sre]]></category>

		<guid isPermaLink="false">https://labs.portcullis.co.uk/?p=6858</guid>
		<description><![CDATA[<p>Presentation on the need to re-examine how we engineer systems (taking service providers as an example) and the implications on how we quantify cyber risk if we want to take this message into the board room (as given at BT&#8217;s SnoopCon 2019 and Cisco&#8217;s June 2019 Knowledge Network webinar for service providers). Having delivered security [&#8230;]</p><p>The post <a href="https://labs.portcullis.co.uk/presentations/security-engineering-a-manifesto-for-defensive-security/">Security Engineering &#8211; A manifesto for defensive security</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Presentation on the need to re-examine how we engineer systems (taking service providers as an example) and the implications on how we quantify cyber risk if we want to take this message into the board room (as given at BT&#8217;s SnoopCon 2019 and Cisco&#8217;s June 2019 <a title="Knowledge Network" href="https://engage2demand.cisco.com/CiscoKnowledgeNetwork">Knowledge Network</a> webinar for service providers).<span id="more-6858"></span></p>
<p>Having delivered security consultancy as part of Portcullis/Cisco for over 15 years, I&#8217;ve seen a variety of shades of broken. Since I recently spent some time on secondment to one of our customers to help them design, build and operationalise security as part of their digital transformation programme, I got to thinking: what would I do if I wanted to get projects delivered right? With apologies to grsec, Jericho Forum, BeyondCorp and Trusted Computing, what followed was part philosophy, part technical brain dump, the result being my take on security engineering and how to build defensible systems. This talk includes the following hits:</p>
<ul>
<li>Helping the blue team – a case study in 3 parts&#8230;</li>
<li>Blue doesn&#8217;t have the man power to adopt gift wrapped improvements let alone offensive research thrown over the wall</li>
<li>Static passwords – why the hell are we still using them?</li>
<li>Vulnerability management – didn’t we say blacklists were bad?</li>
<li>Forget about penetration testing – what are your controls?</li>
<li>Is there another way to report – why don’t businesses listen to us?</li>
<li>Monetising MITRE – can we make money out of CVEs?</li>
</ul>
<div class="wpfilebase-file-default" onclick="if('undefined' == typeof event.target.href) document.getElementById('wpfb-file-link-1').click();">
  <div class="icon"><a href="https://labs.portcullis.co.uk/download/SEAMFDS.pdf" target="_blank" title="Download SEAMFDS"><img align="middle" src="https://labs.portcullis.co.uk/wp-includes/images/crystal/document.png" alt="SEAMFDS" /></a></div>
  <div class="filetitle">
    <a href="https://labs.portcullis.co.uk/download/SEAMFDS.pdf" title="Download SEAMFDS.pdf" target="_blank" id="wpfb-file-link-1">SEAMFDS.pdf</a>
    
    <br />
    June 28, 2019<br />
    
  </div>
  <div class="info">
    311.8 KiB<br />
    MD5 hash: 185701fbc113ca2a676e802b61df53e2 <br />
    <a href="#" onclick="return wpfilebase_filedetails(1);">Details</a>
  </div>
  <div class="details" id="wpfilebase-filedetails1" style="display: none;">
  
  <table border="0">
   
   
   
   
   
   
   <tr><td><strong>Date:</strong></td><td>June 28, 2019</td></tr>
  </table>
  </div>
 <div style="clear: both;"></div>
</div>
<p>The post <a href="https://labs.portcullis.co.uk/presentations/security-engineering-a-manifesto-for-defensive-security/">Security Engineering &#8211; A manifesto for defensive security</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://labs.portcullis.co.uk/presentations/security-engineering-a-manifesto-for-defensive-security/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>So you want to build a SOC: Lessons from the front line</title>
		<link>https://labs.portcullis.co.uk/presentations/so-you-want-to-build-a-soc-lessons-from-the-front-line/</link>
		<comments>https://labs.portcullis.co.uk/presentations/so-you-want-to-build-a-soc-lessons-from-the-front-line/#comments</comments>
		<pubDate>Thu, 20 Jun 2019 14:06:57 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Presentations]]></category>
		<category><![CDATA[blue team]]></category>
		<category><![CDATA[conference]]></category>
		<category><![CDATA[SOC]]></category>
		<category><![CDATA[TTRS]]></category>

		<guid isPermaLink="false">https://labs.portcullis.co.uk/?p=6855</guid>
		<description><![CDATA[<p>Presentation on building an effective operational security capability (as given at Cisco Live US/Talos Threat Research Summit 2019). This talk will not help you build a SOC in only 60 minutes, but it will help you build a functional security operation over time. Building a SOC can be daunting. This talk will look at how [&#8230;]</p><p>The post <a href="https://labs.portcullis.co.uk/presentations/so-you-want-to-build-a-soc-lessons-from-the-front-line/">So you want to build a SOC: Lessons from the front line</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Presentation on building an effective operational security capability (as given at Cisco Live US/Talos Threat Research Summit 2019).<span id="more-6855"></span></p>
<p>This talk will not help you build a SOC in only 60 minutes, but it will help you build a functional security operation over time.</p>
<p>Building a SOC can be daunting. This talk will look at how to pick your fights and the key battles (authentication, logging, etc.) that any operational security team needs to win. The session will discuss how to ensure you formalize existing good practices and just as importantly what gaps may exist in the team’s processes. The session will look at the next steps that any organization intending to set off down this road ought to consider.</p>
<div class="wpfilebase-file-default" onclick="if('undefined' == typeof event.target.href) document.getElementById('wpfb-file-link-2').click();">
  <div class="icon"><a href="https://labs.portcullis.co.uk/download/TTRS19SYWTBASLFTFL.pdf" target="_blank" title="Download TTRS19SYWTBASLFTFL"><img align="middle" src="https://labs.portcullis.co.uk/wp-includes/images/crystal/document.png" alt="TTRS19SYWTBASLFTFL" /></a></div>
  <div class="filetitle">
    <a href="https://labs.portcullis.co.uk/download/TTRS19SYWTBASLFTFL.pdf" title="Download TTRS19SYWTBASLFTFL.pdf" target="_blank" id="wpfb-file-link-2">TTRS19SYWTBASLFTFL.pdf</a>
    
    <br />
    June 20, 2019<br />
    
  </div>
  <div class="info">
    1.6 MiB<br />
    MD5 hash: 9fd544a63fcac10688d82d4cec24df44 <br />
    <a href="#" onclick="return wpfilebase_filedetails(2);">Details</a>
  </div>
  <div class="details" id="wpfilebase-filedetails2" style="display: none;">
  
  <table border="0">
   
   
   
   
   
   
   <tr><td><strong>Date:</strong></td><td>June 20, 2019</td></tr>
  </table>
  </div>
 <div style="clear: both;"></div>
</div>
<p>The post <a href="https://labs.portcullis.co.uk/presentations/so-you-want-to-build-a-soc-lessons-from-the-front-line/">So you want to build a SOC: Lessons from the front line</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://labs.portcullis.co.uk/presentations/so-you-want-to-build-a-soc-lessons-from-the-front-line/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Discover the secrets of the SOC</title>
		<link>https://labs.portcullis.co.uk/presentations/discover-the-secrets-of-the-soc/</link>
		<comments>https://labs.portcullis.co.uk/presentations/discover-the-secrets-of-the-soc/#comments</comments>
		<pubDate>Tue, 18 Jun 2019 08:39:26 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Presentations]]></category>
		<category><![CDATA[blue team]]></category>
		<category><![CDATA[C-Suite]]></category>
		<category><![CDATA[conference]]></category>
		<category><![CDATA[InfoSec Europe]]></category>
		<category><![CDATA[SOC]]></category>

		<guid isPermaLink="false">https://labs.portcullis.co.uk/?p=6846</guid>
		<description><![CDATA[<p>Presentation on building effective SOCs (as given at InfoSec Europe 2019 on the interactive workshop track). Simon Crocker, Cisco&#8217;s EMEAR lead for SOC Advisory looks at what goes into making a SOC work effectively. This talk discusses the core SOC requirements around monitoring and incident response function, but also touches on some of the other [&#8230;]</p><p>The post <a href="https://labs.portcullis.co.uk/presentations/discover-the-secrets-of-the-soc/">Discover the secrets of the SOC</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Presentation on building effective SOCs (as given at InfoSec Europe 2019 on the interactive workshop track).<span id="more-6846"></span></p>
<p><a title="Simon Crocker" href="https://www.infosecurityeurope.com/en/Contributors/7928410/Simon-Crocker">Simon Crocker</a>, Cisco&#8217;s EMEAR lead for SOC Advisory looks at what goes into making a SOC work effectively. </p>
<p>This talk discusses the core SOC requirements around monitoring and incident response function, but also touches on some of the other services that SOCs can also provide.</p>
<p>Learning outcomes:</p>
<ol>
<li>The challenges that SOCs face and approaches to overcome them</li>
<li>The array of services that SOCs provide</li>
<li>The roadmap to build a SOC</li>
<li>Learn how to threat hunt proactively to root out hidden threats</li>
<li>Discover best practice on threat hunting from the largest non government threat intelligence team</li>
</ol>
<div class="wpfilebase-file-default" onclick="if('undefined' == typeof event.target.href) document.getElementById('wpfb-file-link-3').click();">
  <div class="icon"><a href="https://labs.portcullis.co.uk/download/I2019DTSOTC.pdf" target="_blank" title="Download I2019DTSOTC"><img align="middle" src="https://labs.portcullis.co.uk/wp-includes/images/crystal/document.png" alt="I2019DTSOTC" /></a></div>
  <div class="filetitle">
    <a href="https://labs.portcullis.co.uk/download/I2019DTSOTC.pdf" title="Download I2019DTSOTC.pdf" target="_blank" id="wpfb-file-link-3">I2019DTSOTC.pdf</a>
    
    <br />
    June 18, 2019<br />
    
  </div>
  <div class="info">
    925.6 KiB<br />
    MD5 hash: 904adc3b1b54f73227ad53807bac5004 <br />
    <a href="#" onclick="return wpfilebase_filedetails(3);">Details</a>
  </div>
  <div class="details" id="wpfilebase-filedetails3" style="display: none;">
  
  <table border="0">
   
   
   
   
   
   
   <tr><td><strong>Date:</strong></td><td>June 18, 2019</td></tr>
  </table>
  </div>
 <div style="clear: both;"></div>
</div>
<p>The post <a href="https://labs.portcullis.co.uk/presentations/discover-the-secrets-of-the-soc/">Discover the secrets of the SOC</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://labs.portcullis.co.uk/presentations/discover-the-secrets-of-the-soc/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Use Infrastructure as Code they said. Easier to audit they said&#8230; (part 1)</title>
		<link>https://labs.portcullis.co.uk/blog/use-infrastructure-as-code-they-said-easier-to-audit-they-said-part-1/</link>
		<comments>https://labs.portcullis.co.uk/blog/use-infrastructure-as-code-they-said-easier-to-audit-they-said-part-1/#comments</comments>
		<pubDate>Sat, 26 Jan 2019 22:06:06 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[auditing]]></category>
		<category><![CDATA[devops]]></category>
		<category><![CDATA[devsecops]]></category>
		<category><![CDATA[infradev]]></category>
		<category><![CDATA[orchestration]]></category>
		<category><![CDATA[seceng]]></category>
		<category><![CDATA[secops]]></category>
		<category><![CDATA[sre]]></category>
		<category><![CDATA[training]]></category>

		<guid isPermaLink="false">https://labs.portcullis.co.uk/?p=6839</guid>
		<description><![CDATA[<p>Whilst there are some great examples of how to assess infrastructure as code dynamically with things like the Center for Internet Security&#8216;s Docker benchmark and CoreOS&#8216;s Clair, these kinda run a little too late in the pipeline for my liking. If we want to treat infrastructure as code then surely we ought to be performing [&#8230;]</p><p>The post <a href="https://labs.portcullis.co.uk/blog/use-infrastructure-as-code-they-said-easier-to-audit-they-said-part-1/">Use Infrastructure as Code they said. Easier to audit they said&#8230; (part 1)</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Whilst there are some great examples of how to assess infrastructure as code dynamically with things like the <a title="Center for Internet Security" href="https://www.cisecurity.org/">Center for Internet Security</a>&#8216;s <a title="Docker benchmark" href="https://www.cisecurity.org/benchmark/docker/">Docker benchmark</a> and <a title="CoreOS" href="https://github.com/coreos/">CoreOS</a>&#8216;s <a title="Clair" href="https://github.com/coreos/clair">Clair</a>, these kinda run a little too late in the pipeline for my liking. If we want to treat infrastructure as code then surely we ought to be performing code reviews and if we&#8217;re performing code reviews then perhaps we can perform a subset of these checks automatically pre-commit?<span id="more-6839"></span></p>
<p>Many of the current generation of infrastructure orchestration tools utilise Domain Specific Languages presented through the medium of YAML, JSON etc which allow the infradev team to specify programmatically, the architecture and nature of the infrastructure they manage. Just how secure are these language and where might we find gaps that an offensive party might seek to exploit? In practice, what I was really thinking was, if I want to review commits (automatically), then what exactly do I want my tools to look for and why? This seems like an obvious question but at that point, I hadn&#8217;t seen a huge amount of talk (or more importantly, based on the work I do, evidence) on how others were doing this to review their templates before they&#8217;d been built and deployed&#8230;.</p>
<p>The good news is that somewhere along the way, whilst I was still asking around and before I started to work on this series of posts, I discovered <a title="cfn_nag" href="https://github.com/stelligent/cfn_nag">cfn_nag</a> which looked like a great start, albeit only if you&#8217;re working on <a title="AWS" href="https://aws.amazon.com/">AWS</a>&#8216;s <a title="CloudFormation" href="https://aws.amazon.com/cloudformation/">CloudFormation</a> platform. Taking inspiration from this discovery, my next search was for a linting tool for Ansible (my preferred choice for infrastructure orchestration) and this too yielded results, namely <a title="ansible-lint" href="https://github.com/ansible/ansible-lint">ansible-lint</a>. It turns out that there is more going on than I&#8217;d originally feared but that if you want to do this kind of thing (and you should), you really want to be looking for linting tools for your preferred templating language. One observation I&#8217;ll make however is that many of these linters don&#8217;t appear to have a regular stream of updates and that they may only support a limited set of checks.</p>
<p>In the next part of my thought experiment, we’ll take a deeper dive and I&#8217;ll start to consider just how effective these linters are, looking at both the theory of static analysis and code review as it applies to secure development more generally and just as importantly, looking at the assurance these tools can give you.</p>
<p>The post <a href="https://labs.portcullis.co.uk/blog/use-infrastructure-as-code-they-said-easier-to-audit-they-said-part-1/">Use Infrastructure as Code they said. Easier to audit they said&#8230; (part 1)</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://labs.portcullis.co.uk/blog/use-infrastructure-as-code-they-said-easier-to-audit-they-said-part-1/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>An offensive introduction to Active Directory on UNIX</title>
		<link>https://labs.portcullis.co.uk/blog/an-offensive-introduction-to-active-directory-on-unix/</link>
		<comments>https://labs.portcullis.co.uk/blog/an-offensive-introduction-to-active-directory-on-unix/#comments</comments>
		<pubDate>Thu, 06 Dec 2018 09:18:36 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[analysis]]></category>
		<category><![CDATA[auditing]]></category>
		<category><![CDATA[Black Hat Europe]]></category>
		<category><![CDATA[blue team]]></category>
		<category><![CDATA[conference]]></category>
		<category><![CDATA[exploit]]></category>
		<category><![CDATA[hardening]]></category>
		<category><![CDATA[red team]]></category>
		<category><![CDATA[root]]></category>
		<category><![CDATA[training]]></category>
		<category><![CDATA[UNIX]]></category>
		<category><![CDATA[Windows]]></category>

		<guid isPermaLink="false">https://labs.portcullis.co.uk/?p=6805</guid>
		<description><![CDATA[<p>By way of an introduction to our talk at Black Hat Europe, Security Advisory EMEAR would like to share the background on our recent research into some common Active Directory integration solutions. Just as with Windows, these solutions can be utilized to join UNIX infrastructure to enterprises&#8217; Active Directory forests. Background to Active Directory integration [&#8230;]</p><p>The post <a href="https://labs.portcullis.co.uk/blog/an-offensive-introduction-to-active-directory-on-unix/">An offensive introduction to Active Directory on UNIX</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>By way of an introduction to <a href="https://www.blackhat.com/eu-18/briefings/schedule/index.html#where-2-worlds-collide-bringing-mimikatz-et-al-to-unix-12962" title="our talk">our talk</a> at Black Hat Europe, <a href="https://www.cisco.com/c/en/us/products/security/advisory-services.html" title="Security Advisory EMEAR">Security Advisory EMEAR</a> would like to share the background on our recent research into some common Active Directory integration solutions. Just as with Windows, these solutions can be utilized to join UNIX infrastructure to enterprises&#8217; Active Directory forests.<span id="more-6805"></span></p>
<h2>Background to Active Directory integration solutions</h2>
<p>Having seen an uptick in unique UNIX infrastructures that are integrated into customers&#8217; existing Active Directory forests, the question becomes, &#8220;Does this present any concerns that may not be well understood?&#8221; This quickly became &#8220;What if an adversary could get into a UNIX box and then breach your domain?&#8221;<br />
Within a typical Active Directory integration solution (in this case <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/5/html/5.7_release_notes/sssd" title="SSSD">SSSD</a>), the solution shares a striking similarity to what a user might see on Windows. Notably, you have:</p>
<ul>
<li>DNS &#8211; Used for name resolution</li>
<li>LDAP &#8211; Used for &#8220;one-time identification&#8221; and assertion of identity</li>
<li>Kerberos &#8211; Used for ongoing authentication</li>
<li>SSSD &#8211; Like LSASS</li>
<li>PAM &#8211; Like msgina.dll or the more modern credential providers</li>
</ul>
<p>You can see a breakdown of this process <a title="here" href="https://rhelblog.redhat.com/2015/02/04/overview-of-direct-integration-options/">here</a>. Unlike Windows, there is no Group Policy for the most part (with some exceptions), so policies for sudo et al. are typically pushed as flat files to hosts.</p>
<h2>Our research</h2>
<p>Realistically, the threat models associated with each part of the implementation should be quite familiar to anyone securing a heterogeneous Windows network. Having worked with a variety of customers, it becomes apparent that the typical UNIX administrator who does not have a strong background in Windows and Active Directory will be ill-equipped to handle this threat. While we&#8217;ve been talking about successful attacks against components such as LSASS and Kerberos for quite some time, Mimikatz dates back to at least April 2014, and dumping hashes has been around even longer. Pwdump, which dumped local Windows hashes, was published by Jeremy Allison in 1997). However, no one has really taken a concerted look at whether these attacks are possible on UNIX infrastructure, nor how a blue team might spot an adversary performing them.</p>
<p>As a result of this research, we were able to develop tactics, tools, and procedures that might further assist an attacker in breaching an enterprise, and we began documenting and developing appropriate strategies to allow blue teams to appropriately detect and respond to such incursions. The Black Hat EU slides can be found <a title="here" href="/presentations/where-2-worlds-collide-bringing-mimikatz-et-al-to-unix/">here</a> and whilst the tools we developed can be found on <a href="https://github.com/portcullislabs/linikatz" title="our GitHub repo">our GitHub repo</a>.</p>
<p>The post <a href="https://labs.portcullis.co.uk/blog/an-offensive-introduction-to-active-directory-on-unix/">An offensive introduction to Active Directory on UNIX</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://labs.portcullis.co.uk/blog/an-offensive-introduction-to-active-directory-on-unix/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Where 2 worlds collide: Bringing Mimikatz et al to UNIX</title>
		<link>https://labs.portcullis.co.uk/presentations/where-2-worlds-collide-bringing-mimikatz-et-al-to-unix/</link>
		<comments>https://labs.portcullis.co.uk/presentations/where-2-worlds-collide-bringing-mimikatz-et-al-to-unix/#comments</comments>
		<pubDate>Thu, 06 Dec 2018 08:04:06 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Presentations]]></category>
		<category><![CDATA[analysis]]></category>
		<category><![CDATA[auditing]]></category>
		<category><![CDATA[Black Hat Europe]]></category>
		<category><![CDATA[blue team]]></category>
		<category><![CDATA[conference]]></category>
		<category><![CDATA[exploit]]></category>
		<category><![CDATA[hardening]]></category>
		<category><![CDATA[red team]]></category>
		<category><![CDATA[root]]></category>
		<category><![CDATA[training]]></category>
		<category><![CDATA[UNIX]]></category>
		<category><![CDATA[Windows]]></category>

		<guid isPermaLink="false">https://labs.portcullis.co.uk/?p=6806</guid>
		<description><![CDATA[<p>Presentation on Active Directory integration solutions for UNIX (as given at Black Hat Europe 2018). Over the past fifteen years there&#8217;s been an uptick in &#8220;interesting&#8221; UNIX infrastructures being integrated into customers&#8217; existing AD forests. Whilst the threat models enabled by this should be quite familiar to anyone securing a heterogeneous Windows network, they may [&#8230;]</p><p>The post <a href="https://labs.portcullis.co.uk/presentations/where-2-worlds-collide-bringing-mimikatz-et-al-to-unix/">Where 2 worlds collide: Bringing Mimikatz et al to UNIX</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Presentation on Active Directory integration solutions for UNIX (as given at Black Hat Europe 2018).<span id="more-6806"></span></p>
<p>Over the past fifteen years there&#8217;s been an uptick in &#8220;interesting&#8221; UNIX infrastructures being integrated into customers&#8217; existing AD forests. Whilst the threat models enabled by this should be quite familiar to anyone securing a heterogeneous Windows network, they may not be as well understood by a typical UNIX admin who does not have a strong background in Windows and AD. Over the last few months we&#8217;ve spent some time looking a number of specific Active Directory integration solutions (both open and closed source) for UNIX systems and documenting some of the tools, tactics and procedures that enable attacks on the forest to be staged from UNIX.</p>
<p>This talk describes the technical details regarding our findings. It includes Proof of Concepts (PoC) showing real-world attacks against AD joined UNIX systems. Finally, potential solutions or mitigation controls are discussed that will help to either prevent those attacks or at the very least to detect them when they occur.</p>
<p>Tools referenced in this talk include:</p>
<ul>
<li><a href="https://github.com/portcullislabs/linikatz" title="Linikatz">Linikatz</a></li>
<ul>
<li><a href="https://github.com/portcullislabs/linikatz/tree/master/red/JohnTheRipper" title="JohnTheRipper dynamic.conf rules">JohnTheRipper dynamic.conf rules</a></li>
<li><a href="https://github.com/portcullislabs/linikatz/tree/master/red/metasploit-framework" title="metasploit-framework post-exploitation modules">metasploit-framework post-exploitation modules</a></li>
<li><a href="https://github.com/portcullislabs/linikatz/tree/master/blue/audit" title="auditd policies">auditd policies</a></li>
<li><a href="https://github.com/portcullislabs/linikatz/tree/master/tools/vas/fuzzers" title="fuzzers">fuzzers</a></li>
</ul>
</ul>
<div class="wpfilebase-file-default" onclick="if('undefined' == typeof event.target.href) document.getElementById('wpfb-file-link-4').click();">
  <div class="icon"><a href="https://labs.portcullis.co.uk/download/eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf" target="_blank" title="Download Eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX"><img align="middle" src="https://labs.portcullis.co.uk/wp-includes/images/crystal/document.png" alt="Eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX" /></a></div>
  <div class="filetitle">
    <a href="https://labs.portcullis.co.uk/download/eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf" title="Download eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf" target="_blank" id="wpfb-file-link-4">eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf</a>
    
    <br />
    December 6, 2018<br />
    
  </div>
  <div class="info">
    724.9 KiB<br />
    MD5 hash: cc712c5e46b16fbff22a2566b1248a91 <br />
    <a href="#" onclick="return wpfilebase_filedetails(4);">Details</a>
  </div>
  <div class="details" id="wpfilebase-filedetails4" style="display: none;">
  
  <table border="0">
   
   
   
   
   
   
   <tr><td><strong>Date:</strong></td><td>December 6, 2018</td></tr>
  </table>
  </div>
 <div style="clear: both;"></div>
</div>
<p>The post <a href="https://labs.portcullis.co.uk/presentations/where-2-worlds-collide-bringing-mimikatz-et-al-to-unix/">Where 2 worlds collide: Bringing Mimikatz et al to UNIX</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://labs.portcullis.co.uk/presentations/where-2-worlds-collide-bringing-mimikatz-et-al-to-unix/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>The importance of logs: You won&#8217;t see what you don&#8217;t log</title>
		<link>https://labs.portcullis.co.uk/presentations/the-importance-of-logs-you-wont-see-what-you-dont-log/</link>
		<comments>https://labs.portcullis.co.uk/presentations/the-importance-of-logs-you-wont-see-what-you-dont-log/#comments</comments>
		<pubDate>Wed, 31 Oct 2018 12:36:40 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Presentations]]></category>
		<category><![CDATA[blue team]]></category>
		<category><![CDATA[hardening]]></category>
		<category><![CDATA[red team]]></category>
		<category><![CDATA[SecureSouthWest]]></category>
		<category><![CDATA[training]]></category>

		<guid isPermaLink="false">https://labs.portcullis.co.uk/?p=6793</guid>
		<description><![CDATA[<p>Presentation on logging and auditing strategies (as given at Secure South West 11). Building on my blog post on Cisco&#8217;s security blog entitled The Importance of Logs, I put together a presentation that picks apart some of the practical aspects of building a successful logging capability focusing on the need to document &#8220;good&#8221; and curate [&#8230;]</p><p>The post <a href="https://labs.portcullis.co.uk/presentations/the-importance-of-logs-you-wont-see-what-you-dont-log/">The importance of logs: You won&#8217;t see what you don&#8217;t log</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Presentation on logging and auditing strategies (as given at Secure South West 11).<span id="more-6793"></span></p>
<p>Building on my blog post on Cisco&#8217;s security blog entitled <a href="https://blogs.cisco.com/security/the-importance-of-logs">The Importance of Logs</a>, I put together a presentation that picks apart some of the practical aspects of building a successful logging capability focusing on the need to document &#8220;good&#8221; and curate &#8220;bad&#8221;.</p>
<p>The purpose of this talk is not to help you build a SOC in 30 minutes, rather it looks at how logging can go wrong and how to plan in order to get it right. The talk includes some composite case studies which highlight some of the challenges that we&#8217;ve seen over the years (particularly when responding in customer breaches) and makes some suggestions on where interested organisations should focus their efforts next.</p>
<div class="wpfilebase-file-default" onclick="if('undefined' == typeof event.target.href) document.getElementById('wpfb-file-link-5').click();">
  <div class="icon"><a href="https://labs.portcullis.co.uk/download/SSWTIOLYWSWYDL.pdf" target="_blank" title="Download SSWTIOLYWSWYDL"><img align="middle" src="https://labs.portcullis.co.uk/wp-includes/images/crystal/document.png" alt="SSWTIOLYWSWYDL" /></a></div>
  <div class="filetitle">
    <a href="https://labs.portcullis.co.uk/download/SSWTIOLYWSWYDL.pdf" title="Download SSWTIOLYWSWYDL.pdf" target="_blank" id="wpfb-file-link-5">SSWTIOLYWSWYDL.pdf</a>
    
    <br />
    October 31, 2018<br />
    
  </div>
  <div class="info">
    463.7 KiB<br />
    MD5 hash: 390c1d8b29e74f2c15df434b4d0d9f99 <br />
    <a href="#" onclick="return wpfilebase_filedetails(5);">Details</a>
  </div>
  <div class="details" id="wpfilebase-filedetails5" style="display: none;">
  
  <table border="0">
   
   
   
   
   
   
   <tr><td><strong>Date:</strong></td><td>October 31, 2018</td></tr>
  </table>
  </div>
 <div style="clear: both;"></div>
</div>
<p>The post <a href="https://labs.portcullis.co.uk/presentations/the-importance-of-logs-you-wont-see-what-you-dont-log/">The importance of logs: You won&#8217;t see what you don&#8217;t log</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://labs.portcullis.co.uk/presentations/the-importance-of-logs-you-wont-see-what-you-dont-log/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Web Application Whitepaper</title>
		<link>https://labs.portcullis.co.uk/whitepapers/web-application-whitepaper/</link>
		<comments>https://labs.portcullis.co.uk/whitepapers/web-application-whitepaper/#comments</comments>
		<pubDate>Wed, 06 Sep 2017 11:12:46 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Whitepapers]]></category>
		<category><![CDATA[analysis]]></category>
		<category><![CDATA[HTML5]]></category>
		<category><![CDATA[SDL]]></category>
		<category><![CDATA[training]]></category>
		<category><![CDATA[web]]></category>

		<guid isPermaLink="false">https://labs.portcullis.co.uk/?p=6078</guid>
		<description><![CDATA[<p>This document aims to analyse and explore data collected from technical assurance engagements during 2016. The original piece of data analysis was performed by two of our interns (Daniel and Chris) as part of Cisco&#8217;s intended contribution to the next Top 10 publication from OWASP however due to time constraints, our data points were not [&#8230;]</p><p>The post <a href="https://labs.portcullis.co.uk/whitepapers/web-application-whitepaper/">Web Application Whitepaper</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>This document aims to analyse and explore data collected from technical assurance engagements during 2016.<span id="more-6078"></span></p>
<p>The original piece of data analysis was performed by two of our interns (Daniel and Chris) as part of Cisco&#8217;s intended contribution to the next Top 10 publication from OWASP however due to time constraints, our data points were not submitted. As a result, the co-authors (Simone and Isa) chose to compare the EMEAR team&#8217;s statistics from 2016 against the now public 2017 Top 10 published by OWASP. Additionally, they also took a look at the most common web application issues reported by the Team during the last year and analysed their impact and severity.</p>
<div class="wpfilebase-file-default" onclick="if('undefined' == typeof event.target.href) document.getElementById('wpfb-file-link-6').click();">
  <div class="icon"><a href="https://labs.portcullis.co.uk/download/WAW.pdf" target="_blank" title="Download WAW"><img align="middle" src="https://labs.portcullis.co.uk/wp-includes/images/crystal/document.png" alt="WAW" /></a></div>
  <div class="filetitle">
    <a href="https://labs.portcullis.co.uk/download/WAW.pdf" title="Download WAW.pdf" target="_blank" id="wpfb-file-link-6">WAW.pdf</a>
    
    <br />
    September 6, 2017<br />
    Version: 1.0<br />
  </div>
  <div class="info">
    925.6 KiB<br />
    MD5 hash: 0986d3ab7f6f55c71199296189ce5f62 <br />
    <a href="#" onclick="return wpfilebase_filedetails(6);">Details</a>
  </div>
  <div class="details" id="wpfilebase-filedetails6" style="display: none;">
  
  <table border="0">
   
   
   
   
   
   
   <tr><td><strong>Date:</strong></td><td>September 6, 2017</td></tr>
  </table>
  </div>
 <div style="clear: both;"></div>
</div>
<p>The post <a href="https://labs.portcullis.co.uk/whitepapers/web-application-whitepaper/">Web Application Whitepaper</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://labs.portcullis.co.uk/whitepapers/web-application-whitepaper/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Exploring Windows Subsystem for Linux</title>
		<link>https://labs.portcullis.co.uk/blog/exploring-windows-subsystem-for-linux/</link>
		<comments>https://labs.portcullis.co.uk/blog/exploring-windows-subsystem-for-linux/#comments</comments>
		<pubDate>Thu, 27 Jul 2017 09:00:04 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[analysis]]></category>
		<category><![CDATA[Linux]]></category>
		<category><![CDATA[root]]></category>
		<category><![CDATA[Windows]]></category>

		<guid isPermaLink="false">https://labs.portcullis.co.uk/?p=5869</guid>
		<description><![CDATA[<p>Whilst there has been quite a lot of analysis of Microsoft&#8217;s new Windows Subsystem for Linux (aka WSL or Bash on Ubuntu on Windows) and how it functions (particularly from Alex Ionescu), most of this has focused on how it affects the Windows security model. Being a keen UNIX focused researcher, I decided to take [&#8230;]</p><p>The post <a href="https://labs.portcullis.co.uk/blog/exploring-windows-subsystem-for-linux/">Exploring Windows Subsystem for Linux</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Whilst there has been quite a lot of analysis of Microsoft&#8217;s new <a title="Windows Subsystem for Linux" href="https://msdn.microsoft.com/en-gb/commandline/wsl/about">Windows Subsystem for Linux</a> (aka WSL or Bash on Ubuntu on Windows) and how it functions (particularly from <a title="Alex Ionescu" href="https://github.com/ionescu007/lxss">Alex Ionescu</a>), most of this has focused on how it affects the Windows security model. Being a keen UNIX focused researcher, I decided to take it for a spin.<span id="more-5869"></span></p>
<p>The first thing I did once I had it installed was look at how the Windows process tree had changed. Running it results in two new branches to your process tree. The first contains the Windows bash.exe instance which hosts your new terminal:</p>
<ul>
<li>explorer.exe (runs as your user):
<ul>
<li>bash.exe (runs as your user):
<ul>
<li>conhost.exe (runs as your user)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Whilst the second contains the Linux process tree:</p>
<ul>
<li>svchost.exe (runs as SYSTEM):
<ul>
<li>init (runs as your user, no disabled privileges, locked into a job):
<ul>
<li>bash (runs as your user, disabled privileges, locked into a job, break away set to true)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>As you might expect, new code compiled to support this is well hardened and uses Windows 10&#8242;s advanced mitigations. Specifically, bash.exe has the following mitigations enabled:</p>
<ul>
<li>DEP enabled</li>
<li>ASLR high entropy, bottom up</li>
<li>CFG enabled</li>
</ul>
<p>Digging a little further, the same can&#8217;t be said for init, bash and other parts of the Linux process tree. Whilst DEP is enabled, ASLR and CFG are not. In fairness, this shouldn&#8217;t come as any great surprise &#8211; they&#8217;re Ubuntu packaged binaries however it does start to show show how introducing WSL to your system can change the systems posture.</p>
<h2>The kernel</h2>
<p>So what does the &#8220;kernel&#8221; version look like. Well, at the point I examined it:</p>
<pre class="brush: bash; gutter: false; title: ; notranslate">
x@DESKTOP-L4857K3:~$ uname -a
Linux DESKTOP-L4857K3 3.4.0+ #1 PREEMPT Thu Aug 1 17:06:05 CST 2013 x86_64 x86_64 x86_64 GNU/Linux
</pre>
<p>This version of the Linux kernel should be vulnerable to <a title="dirty cow" href="https://dirtycow.ninja/">dirty cow</a>, so what of it? It doesn&#8217;t work which again isn&#8217;t a huge surprise. As Alex has alluded to there is a quite a substantial amount of mapping going on to implement the Linux system calls on Windows and whilst they should be API compatible, the implementations between a real Linux kernel and what WSL gives up may be quite different.</p>
<p>This does however bring up the first critical point: There is no relationship between the patches supplied as part of Windows Update and what goes on with WSL. If you don&#8217;t patch regularly you&#8217;ll still be vulnerable to a whole plethora of Ubuntu (userland) vulnerabilities.</p>
<h2>Memory corruption mitigations</h2>
<p>Some Linux mitigations are in play however (as they would be on any real Ubuntu system) as can be seen with <a title="checksec.sh" href="http://www.trapkit.de/tools/checksec.html">checksec.sh</a>:</p>
<ul>
<li>System-wide ASLR (kernel.randomize_va_space): On (Setting: 2)</li>
<li>Does the CPU support NX: Yes</li>
</ul>
<p>And of course binaries are compiled with whatever <a title="Ubuntu hardening" href="https://wiki.ubuntu.com/Security/Features">Ubuntu hardening</a> is currently supported:</p>
<pre class="brush: bash; gutter: false; title: ; notranslate">
	COMMAND    PID RELRO             STACK CANARY           NX/PaX        PIE
	  init      1 Full RELRO        Canary found           NX enabled    Dynamic Shared Object
	  sudo     14 Partial RELRO     Canary found           NX enabled    Dynamic Shared Object
	    su     15 Partial RELRO     Canary found           NX enabled    No PIE
	  bash     16 Partial RELRO     Canary found           NX enabled    No PIE
	  bash      2 Partial RELRO     Canary found           NX enabled    No PIE
</pre>
<h2>Shared memory</h2>
<p>So what does WSL look like more generally. Well, since I&#8217;ve had some fun with <a title="shared memory" href="https://labs.portcullis.co.uk/whitepapers/memory-squatting-attacks-on-system-v-shared-memory/">shared memory</a>, I wondered how this was implemented. Well, it turns out that it&#8217;s not:</p>
<pre class="brush: bash; gutter: false; title: ; notranslate">
root@DESKTOP-L4857K3:~# ipcs

kernel not configured for shared memory

kernel not configured for semaphores

kernel not configured for message queues
</pre>
<p>Whether this will have any security implications, it&#8217;s difficult to say but at the very least it may stop certain applications from working. Other applications may revert to using other less well tested IPC mechanisms which may expose security issues along the way.</p>
<h2>Debugging</h2>
<p>Moving on, how about debugging something. A simple tool which exercises the ptrace() system call is strace. Here&#8217;s what happens when strace is run on a normal process:</p>
<pre class="brush: bash; gutter: false; title: ; notranslate">
root@DESKTOP-L4857K3:/sys# strace -f printf &quot;test&quot; 2&gt;&amp;1 | head -n 5
execve(&quot;/usr/bin/printf&quot;, [&quot;printf&quot;, &quot;test&quot;], [/* 15 vars */]) = 0
brk(0)                                  = 0xa9d000
...
</pre>
<p>However you can&#8217;t strace PID 1 (as would have been possible on real Linux), instead ptrace() returns an error: &#8220;Operation not permitted&#8221;.</p>
<h2>File systems</h2>
<p>Whilst /mnt doesn&#8217;t show up as a different file system, /mnt/c is actually used to map the underlying Windows system disk. This is immediately peculiar since it is mapped with permissions of 0777 (world readable, world writable amongst others). Moreover any files created under it are created with an owner of root. You&#8217;d think this might be a problem but from what I&#8217;ve seen so far, assuming the Windows file permissions are set right then (because everything (even setUID processes) runs as you from Windows&#8217; perspective) you won&#8217;t be able to access anything inappropriate (think SAM etc). It. Just. Looks. Weird.</p>
<p>Furthermore, the way that WSL implements umasks too is an oddity. umask doesn&#8217;t work on all file system types and in particular the aforementioned /mnt/c. Observe the following:</p>
<pre class="brush: plain; gutter: false; title: ; notranslate">
root@DESKTOP-L4857K3:/# umask 666
root@DESKTOP-L4857K3:/# touch foo
root@DESKTOP-L4857K3:/# ls -la foo
---------- 1 root root 0 Mar 28 23:10 foo
root@DESKTOP-L4857K3:~# rm foo
root@DESKTOP-L4857K3:~# cd /mnt/c/Users/x/
root@DESKTOP-L4857K3:/mnt/c/Users/x# touch foo
root@DESKTOP-L4857K3:/mnt/c/Users/x# ls -la foo
-rwxrwxrwx 1 root root 0 Mar 28 23:10 foo
</pre>
<p>Umask is honoured in the first location but not the second (a umask of 0666 should mean that files are created with no permissions). Whilst there&#8217;s a fundamental Windows reason why this is the case, there is nothing to indicate this to the Ubuntu instance&#8217;s userland and thus files created within your home directory might be created with undesirable permissions. Microsoft are tracking this in the GitHub as <a title="issue 352" href="https://github.com/Microsoft/BashOnWindows/issues/352">issue 352</a>.</p>
<h2>Authentication</h2>
<p>Unlike on a real Ununtu there&#8217;s no terminal level authentication (whilst user accounts within the Ubuntu instance do have passwords, they&#8217;re not needed unless you want to access the system remotely or gain root privileges via sudo). Moreover, from Windows&#8217; perspective there is no difference between UID 0 and UID 1000. You can start a terminal and then use sudo to elevate your privileges and Windows will be none the wiser (Linux capabilities aren&#8217;t mapped into Windows user rights or special tokens). That might mean that users won&#8217;t care too much about their Ubuntu instance&#8217;s passwords but as you can imagine with no password policy enforcement, users might be tempted to reuse their Windows passwords.</p>
<p>I should also note that whilst sudo prompts for a password on each new instance of bash.exe/conhost.exe pair hosting a terminal however if you authenticate to sudo, close the terminal and then reopen it, then your sudo ticket may still be valid &#8211; this requires exact co-ordination as sudo sessions are tracked by PID, however the first terminal opened will always have a Linux bash process with a PID of 2 which may well be blessed from a previous sudo session.</p>
<h2>Privileges</h2>
<p>Finally, as per issue <a title="issue 561" href="https://github.com/Microsoft/BashOnWindows/issues/561">issue 561</a>, because everything runs as you from Windows&#8217; perspective, the only way to successfully execute ping (which requires an ICMP raw socket on Linux) is to run bash.exe in elevated mode (as Administrator). This, despite the fact that a non-elevated user can quite happily execute ping on the Windows host. WSL doesn&#8217;t even implement concept of root in any real sense, let along implement the necessary Linux syscalls to support capabilities in any useful fashion. This in turn means that everything else spawned from the elevated shell also runs with Windows administrative privileges. For comparison, here&#8217;s what the new branches of your process tree will look like:</p>
<ul>
<li>wininit.exe.exe (runs as SYSTEM):
<ul>
<li>services.exe (runs as SYSTEM):
<ul>
<li>svchost.exe (runs as SYSTEM):
<ul>
<li>RuntimeBroker.exe (runs as your user, disabled privileges, not elevated):
<ul>
<li>bash.exe (runs as your user, disabled privileges, elevated):
<ul>
<li>conhost.exe (runs as your user, disabled privileges, elevated)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The first contains the Windows bash.exe instance which hosts your new terminal, whilst the second contains the Linux process tree:</p>
<ul>
<li>svchost.exe (runs as SYSTEM):
<ul>
<li>init (runs as your user, no disabled privileges, locked into a job, elevated):
<ul>
<li>bash (runs as your user, disabled privileges, locked into a job, break away set to true, elevated):
<ul>
<li>sudo (runs as your user, disabled privileges, locked into a job, break away set to true, elevated):
<ul>
<li>ping (runs as your user, disabled privileges, locked into a job, break away set to true, elevated)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Microsoft&#8217;s stock answer is that the Ubuntu instance (or rather the bash.exe instance hosting the terminal and accompanying lxss.sys kernel implementation) is locked down, effectively sandboxed by a combination of Windows DACLs, the concept of <a href="jobs" href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms684161(v=vs.85).aspx">jobs</a> (touched upon at the start and akin to Linux <a title="cgroups" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Resource_Management_Guide/ch01.html">cgroups</a>) and syscall mapping that effectively uses lxss.sys to <a title="proxy" href="https://blogs.msdn.microsoft.com/wsl/2016/06/08/wsl-system-calls/">proxy</a> most syscalls onto their corresponding NT kernel implementation.</p>
<h2>Conclusion</h2>
<p>The design of WSL seems to be relatively robust if slightly odd, however time will tell, particularly if offensive teams pick up the whiff of a new opportunity. If nothing else, take this article as a reminder that WSL should not be considered a security boundary and that it will remain unmanaged irrespective of how you administer your Windows hosts.</p>
<p>The post <a href="https://labs.portcullis.co.uk/blog/exploring-windows-subsystem-for-linux/">Exploring Windows Subsystem for Linux</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://labs.portcullis.co.uk/blog/exploring-windows-subsystem-for-linux/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>padmin to root: Roles on AIX</title>
		<link>https://labs.portcullis.co.uk/blog/padmin-to-root-roles-on-aix/</link>
		<comments>https://labs.portcullis.co.uk/blog/padmin-to-root-roles-on-aix/#comments</comments>
		<pubDate>Fri, 02 Oct 2015 14:47:26 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[AIX]]></category>
		<category><![CDATA[analysis]]></category>
		<category><![CDATA[auditing]]></category>
		<category><![CDATA[exploit]]></category>
		<category><![CDATA[root]]></category>
		<category><![CDATA[UNIX]]></category>

		<guid isPermaLink="false">https://labs.portcullis.co.uk/?p=5255</guid>
		<description><![CDATA[<p>Following a recent post from a consultant at IBM discussing how how privileged access should be performed on VIOS, I figured it was time to share some of our research in this arena. Those of you that are regular readers will know that I love root. For those of you that are new, welcome aboard. [&#8230;]</p><p>The post <a href="https://labs.portcullis.co.uk/blog/padmin-to-root-roles-on-aix/">padmin to root: Roles on AIX</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Following a recent post from a consultant at IBM discussing how <a title="how privileged access should be performed on VIOS" href="https://www.ibm.com/developerworks/community/blogs/AIXDownUnder/entry/VIOS_switching_between_padmin_and_root1?lang=en">how privileged access should be performed on VIOS</a>, I figured it was time to share some of our research in this arena. Those of you that are regular readers will know that I love <a title="root" href="/tag/root/">root</a>. For those of you that are new, welcome aboard.<span id="more-5255"></span></p>
<p>Let&#8217;s start by defining what VIOS is. VIOS is a subsystem that runs on a logical partition (LPAR) which manages shared hardware such as disks and network adaptors and allows other LPARs to access them. VIOS is managed via a special padmin account which gives access to a restricted shell from where the hardware can be managed. In practice, however it&#8217;s just another AIX LPAR and as the blog post from IBM notes, setup_oem_env can be used to move from the padmin user to the root user.</p>
<p>Firstly, note that setup_oem_env is not setUID. So how does it work? Examining the padmin user we see that it has a single role (PAdmin):</p>
<p>The membership of a role is determined by /etc/security/user but we can examine a specific use using the rolelist command like so:</p>
<pre class="brush: bash; gutter: false; title: ; notranslate">
$ rolelist -u padmin
PAdmin
</pre>
<p>You can also find your current active role using the -e flag to rolelist. Moving on, what does the PAdmin role mean?</p>
<p>Roles are defined in /etc/security/role but as with role membership, we can also use shell commands to enumerate them. For example, the following shows what authorisations the PAdmin role has:</p>
<pre class="brush: bash; gutter: false; title: ; notranslate">
$ lsrole PAdmin
PAdmin
authorizations=vios.device,vios.fs,vios.install,vios.lvm,vios.network,vios.security,vios.system,vios.oemsetupenv,vios.system.cluster,aix.system.config.artex
rolelist= groups=staff visibility=1 screens=* dfltmsg= msgcat= auth_mode=INVOKER
id=23
</pre>
<p>In the context of getting root, vios.oemsetupenv is the charm. This and other AIX authorisations are defined in /etc/security/privcmds. It is possible to specify what commands the possessor of the vios.oemsetupenv authorisation can run (and indeed the privileges with which those commands will ultimately be executed).</p>
<p>You see, AIX like Solaris, is gradually getting rid of the concept that uid=0 is god. IBM haven&#8217;t taken this as far as Oracle yet but there&#8217;s nothing to stop a dedicated administrator from leveraging this functionality. So, if you&#8217;re auditing an AIX box, I would very much recommend checking what roles users have (via /etc/security/user) to ensure that no appropriate roles have been assigned.</p>
<p>PS I&#8217;ve never seen this used in practice (outside of VIOS), but I&#8217;m sure there will be a first time.<br />
PPS rolelist -p will tell you what roles a given process has.<br />
PPPS esaadmin has the SysConfig role but it&#8217;s not normally an active account.</p>
<p>The post <a href="https://labs.portcullis.co.uk/blog/padmin-to-root-roles-on-aix/">padmin to root: Roles on AIX</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://labs.portcullis.co.uk/blog/padmin-to-root-roles-on-aix/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
	</channel>
</rss>
