<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Portcullis Labs &#187; HTML5</title>
	<atom:link href="https://labs.portcullis.co.uk/tag/html5/feed/" rel="self" type="application/rss+xml" />
	<link>https://labs.portcullis.co.uk</link>
	<description>Research and Development</description>
	<language>en-US</language>
		<sy:updatePeriod>hourly</sy:updatePeriod>
		<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=3.8.5</generator>
	<item>
		<title>Web Application Whitepaper</title>
		<link>https://labs.portcullis.co.uk/whitepapers/web-application-whitepaper/</link>
		<comments>https://labs.portcullis.co.uk/whitepapers/web-application-whitepaper/#comments</comments>
		<pubDate>Wed, 06 Sep 2017 11:12:46 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Whitepapers]]></category>
		<category><![CDATA[analysis]]></category>
		<category><![CDATA[HTML5]]></category>
		<category><![CDATA[SDL]]></category>
		<category><![CDATA[training]]></category>
		<category><![CDATA[web]]></category>

		<guid isPermaLink="false">https://labs.portcullis.co.uk/?p=6078</guid>
		<description><![CDATA[<p>This document aims to analyse and explore data collected from technical assurance engagements during 2016. The original piece of data analysis was performed by two of our interns (Daniel and Chris) as part of Cisco&#8217;s intended contribution to the next Top 10 publication from OWASP however due to time constraints, our data points were not [&#8230;]</p><p>The post <a href="https://labs.portcullis.co.uk/whitepapers/web-application-whitepaper/">Web Application Whitepaper</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>This document aims to analyse and explore data collected from technical assurance engagements during 2016.<span id="more-6078"></span></p>
<p>The original piece of data analysis was performed by two of our interns (Daniel and Chris) as part of Cisco&#8217;s intended contribution to the next Top 10 publication from OWASP however due to time constraints, our data points were not submitted. As a result, the co-authors (Simone and Isa) chose to compare the EMEAR team&#8217;s statistics from 2016 against the now public 2017 Top 10 published by OWASP. Additionally, they also took a look at the most common web application issues reported by the Team during the last year and analysed their impact and severity.</p>
<div class="wpfilebase-file-default" onclick="if('undefined' == typeof event.target.href) document.getElementById('wpfb-file-link-1').click();">
  <div class="icon"><a href="https://labs.portcullis.co.uk/download/WAW.pdf" target="_blank" title="Download WAW"><img align="middle" src="https://labs.portcullis.co.uk/wp-includes/images/crystal/document.png" alt="WAW" /></a></div>
  <div class="filetitle">
    <a href="https://labs.portcullis.co.uk/download/WAW.pdf" title="Download WAW.pdf" target="_blank" id="wpfb-file-link-1">WAW.pdf</a>
    
    <br />
    September 6, 2017<br />
    Version: 1.0<br />
  </div>
  <div class="info">
    925.6 KiB<br />
    MD5 hash: 0986d3ab7f6f55c71199296189ce5f62 <br />
    <a href="#" onclick="return wpfilebase_filedetails(1);">Details</a>
  </div>
  <div class="details" id="wpfilebase-filedetails1" style="display: none;">
  
  <table border="0">
   
   
   
   
   
   
   <tr><td><strong>Date:</strong></td><td>September 6, 2017</td></tr>
  </table>
  </div>
 <div style="clear: both;"></div>
</div>
<p>The post <a href="https://labs.portcullis.co.uk/whitepapers/web-application-whitepaper/">Web Application Whitepaper</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://labs.portcullis.co.uk/whitepapers/web-application-whitepaper/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>You can&#8217;t even trust your own reflection these days&#8230;</title>
		<link>https://labs.portcullis.co.uk/blog/you-cant-even-trust-your-own-reflection-these-days/</link>
		<comments>https://labs.portcullis.co.uk/blog/you-cant-even-trust-your-own-reflection-these-days/#comments</comments>
		<pubDate>Wed, 05 Nov 2014 17:37:34 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[analysis]]></category>
		<category><![CDATA[exploit]]></category>
		<category><![CDATA[HTML5]]></category>
		<category><![CDATA[phishing]]></category>
		<category><![CDATA[web]]></category>

		<guid isPermaLink="false">https://labs.portcullis.co.uk/?p=4794</guid>
		<description><![CDATA[<p>Recently, researchers at Trustwave&#8217;s SpiderLabs spoke at Black Hat Europe on the dangers of simply reflecting data back to the requesting user as part of an HTTP request/response exchange. When you think about it, this stands to reason, after all, it&#8217;s what Cross-site Scripting attacks are born from. What&#8217;s interesting is that the new research [&#8230;]</p><p>The post <a href="https://labs.portcullis.co.uk/blog/you-cant-even-trust-your-own-reflection-these-days/">You can&#8217;t even trust your own reflection these days&#8230;</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Recently, researchers at Trustwave&#8217;s SpiderLabs spoke at Black Hat Europe on the dangers of simply reflecting data back to the requesting user as part of an HTTP request/response exchange. When you think about it, this stands to reason, after all, it&#8217;s what Cross-site Scripting attacks are born from. What&#8217;s interesting is that the new research discussed another way in which it could be exploited.<span id="more-4794"></span></p>
<p>The basic premise of the attack (as described on SpiderLabs&#8217;s <a title="Reflected File Download whitepaper" href="http://blog.spiderlabs.com/2014/10/reflected-file-download-the-white-paper.html">Reflected File Download whitepaper</a>) is as follows:</p>
<ol>
<li>The user follows a malicious link to a trusted web site</li>
<li>An executable file is downloaded and saved on the userâ€™s machine. All security indicators show that the file was hosted on the trusted web site</li>
<li>The user executes the file which contains shell commands that gain complete control over the computer</li>
</ol>
<p>So how does it work? On a recent engagement, <a title="AMM" href="https://labs.portcullis.co.uk/author/amm/">one of our consultants</a> found a similar issue. In their case, it was a stored variant of the issue SpiderLabs describe but in other regards, it was identical. The consultant discovered that the application they were testing used two APIs that allowed for the storage and retrieval of data, like so:</p>
<pre class="brush: plain; gutter: false; title: ; notranslate">
POST /putData HTTP/1.0
...
{&quot;id&quot;:12345, &quot;input&quot;:&quot;asdf||calc.exe||pause&quot;}
</pre>
<p>This data could then be retrieved using the following URL:</p>
<ul>
<li>http://URL/getData/12345;1.bat</li>
</ul>
<p>Requesting this in a browser results in the browser believing that the user has downloaded what appeared to be a batch file called 12345;1.bat. If the user executes this file, then calc.exe (part of our original input) will be executed.</p>
<p>As with other similar attacks, which exploit variances in how user controlled data is treated by different components of a solution (in this case, the browser and the server), once you know what to watch out for, it&#8217;s fairly easy to mitigate.</p>
<p>Specifically:</p>
<ul>
<li>Validate all user input</li>
<li>Sanitise by means of context sensitive encoding/escaping any user input that remains</li>
<li>Avoid wildcard mappings such as /getdata/* on exposed web services</li>
<li>Ensure that you&#8217;re correctly setting the important HTTP headers such as Content-Type and Content-Disposition (and other related headers such as X-Content-Type-Options) so that direct requests for the URL cause the file to be downloaded</li>
</ul>
<p>This last point is particularly important, browsers will often attempt to automatically render downloaded content using whatever application is rendered for the target file type. Sending a Content-Disposition header of:</p>
<pre class="brush: plain; gutter: false; title: ; notranslate">
attachment; filename=1.txt
</pre>
<p>precludes this, as no matter whether it is saved or opened, it will be treated as text, a <a title="relatively safe" href="http://comments.gmane.org/gmane.comp.security.oss.general/14512">relatively safe</a> file type.</p>
<p>All in all, a nice catch and one we&#8217;ll definitely use in our red team engagements.</p>
<p>The post <a href="https://labs.portcullis.co.uk/blog/you-cant-even-trust-your-own-reflection-these-days/">You can&#8217;t even trust your own reflection these days&#8230;</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://labs.portcullis.co.uk/blog/you-cant-even-trust-your-own-reflection-these-days/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>cspCalculator</title>
		<link>https://labs.portcullis.co.uk/tools/cspcalculator/</link>
		<comments>https://labs.portcullis.co.uk/tools/cspcalculator/#comments</comments>
		<pubDate>Wed, 08 Jan 2014 15:35:09 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Tools]]></category>
		<category><![CDATA[HTML5]]></category>
		<category><![CDATA[SDL]]></category>
		<category><![CDATA[training]]></category>

		<guid isPermaLink="false">https://labs.portcullis.co.uk/?p=1110</guid>
		<description><![CDATA[<p>cspCalculator is a PoC implementation of a dynamic Content Security Policy creator. Key features Allows on the fly manipulation of Content Security Policy Enables UX developers to get visual feedback on how a CSP affects the application functionality Minimises the changes required to an existing application to allow this to happen Overview Content Security Policies [&#8230;]</p><p>The post <a href="https://labs.portcullis.co.uk/tools/cspcalculator/">cspCalculator</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>cspCalculator is a PoC implementation of a dynamic <a title="Content Security Policy" href="http://en.wikipedia.org/wiki/Content_Security_Policy">Content Security Policy</a> creator.<span id="more-1110"></span></p>
<h2>Key features</h2>
<ul>
<li>Allows on the fly manipulation of Content Security Policy</li>
<li>Enables UX developers to get visual feedback on how a CSP affects the application functionality</li>
<li>Minimises the changes required to an existing application to allow this to happen</li>
</ul>
<h2>Overview</h2>
<p>Content Security Policies are a new feature of modern browsers that support HTML 5 designed to augment the traditional Same Origin Policy of browsers and help to limit the potential impact of Cross-site Scripting and other content manipulation vulnerabilities that may exist within a given web site and which could be exploited by an attacker. It allows allows web site owners to declare approved sources of content that browsers should be allowed to load on that page out-of-band through the use of additional HTTP headers.</p>
<p>The aim here is to minimise the leg work for UX developers in creating web applications that both function and utilise secure development practices. We do this by reducing the server side code changes down to the injection of some client side JavaScript along with a few lines of server side stub code (in this case, in PHP). Once this has been integrated into application in a staging environment, the UX developer can tweak the CSP from their own browser and see how it affects the application functionality :).</p>
<h2>Installation</h2>
<ul>
<li>Copy styles and js from src/html to your web root</li>
<li>Copy index.php from src/html/examples/php to your web root or tweak your existing web pages in a similar fashion</li>
</ul>
<h2>Usage</h2>
<p>The client side code (HTML) should include the following changes:</p>
<pre class="brush: jscript; title: ; notranslate">
&lt;head&gt;
...
	&lt;link rel=&quot;stylesheet&quot; href=&quot;styles/cspCalculator.css&quot; type=&quot;text/css&quot;/&gt;
...
&lt;/head&gt;
&lt;body&gt;
	&lt;script src=&quot;js/cspCalculator.js&quot;&gt;&lt;/script&gt;
	...
&lt;/body&gt;
</pre>
<p>This will result in the CSS and JavaScript used to construct the cspCalculator UI being injected into resultant pages.</p>
<p>Additionally, as a minimum case, the server side code should implement the following logic:</p>
<pre class="brush: php; title: ; notranslate">
$directiveslist = array(&quot;default-src&quot;, &quot;connect-src&quot;, &quot;font-src&quot;, &quot;frame-src&quot;, &quot;img-src&quot;, &quot;media-src&quot;, &quot;object-src&quot;, &quot;script-src&quot;, &quot;style-src&quot;, &quot;sandbox&quot;);
$headerslist =  array(&quot;Content-Security-Policy&quot;, &quot;X-Content-Security-Policy&quot;, &quot;X-WebKit-CSP&quot;);
foreach ($directiveslist as $directivename) {
	header(&quot;Set-Cookie: &quot; . $directivename . &quot;=&quot; . $_COOKIE[$directivename], false);
}
foreach ($headerslist as $headername) {
	$headervalue = &quot;&quot;;
	foreach ($directiveslist as $directivename) {
		$headervalue .= &quot;; &quot; . $directivename . &quot; &quot; . $_COOKIE[$directivename];
	}
	header($headername . &quot;: &quot; . $headervalue);
}
</pre>
<p>We use cookies as a back channel to allow changes to the Content Security Policy by the UX developer from the UI to easily be signaled back to the web application so that the appropriate headers can be set. Cookies work nicely for this purpose as they do not interfere with any GET or POST parameters that the application may need to send for normal operation.</p>
<p>Once operational, your web application will now include a drop down cspCalculator box on each of its pages. Within the drop down you will see various text boxes for each of the CSP directives that can be defined. The &#8220;Calculate&#8221; button next to each will attempt to determine the appropriate policy by examining the page&#8217;s DOM (something that isn&#8217;t 100% effective yet). The &#8220;Apply&#8221; button will force a round-trip to the server to force it to send the page with the new CSP headers applied. It is recommended that you use this tool in combination with something such as Chrome&#8217;s Inspect Element feature to identify any DOM elements that are blocked and which cspCalculator is unable to identify automatically.</p>
<p><em>cspCalculator should not be deployed in a production environment, since the setting of cookies and/or a CSP by use of header() calls may itself introduce other classes of vulnerability. Rather, once the appropriate CSP has been identified it should be set statically through the use of header() (as in PHP) or other similar calls.</em></p>
<h2>Examples</h2>
<p>Since cspCalculator isn&#8217;t particularly easy to demonstrate in a static context, a demo version has been deployed for your amusement. This can be found on at <a title="www.cspcalculator.org" href="http://www.cspcalculator.org/">www.cspcalculator.org</a>. It has been presented on a separate domain to minimise the risks outlined above in the Usage section of this page.</p>
<div class="wpfilebase-file-default" onclick="if('undefined' == typeof event.target.href) document.getElementById('wpfb-file-link-2').click();">
  <div class="icon"><a href="https://labs.portcullis.co.uk/download/cspCalculator-0.2.tar.gz" target="_blank" title="Download CspCalculator-0.2 Tar"><img align="middle" src="https://labs.portcullis.co.uk/wp-includes/images/crystal/archive.png" alt="CspCalculator-0.2 Tar" /></a></div>
  <div class="filetitle">
    <a href="https://labs.portcullis.co.uk/download/cspCalculator-0.2.tar.gz" title="Download cspCalculator-0.2.tar.gz" target="_blank" id="wpfb-file-link-2">cspCalculator-0.2.tar.gz</a>
    
    <br />
    November 29, 2013<br />
    
  </div>
  <div class="info">
    14.2 KiB<br />
    MD5 hash: 496b55e3ffa575178428d1d85e42e113 <br />
    <a href="#" onclick="return wpfilebase_filedetails(2);">Details</a>
  </div>
  <div class="details" id="wpfilebase-filedetails2" style="display: none;">
  
  <table border="0">
   
   
   
   
   
   
   <tr><td><strong>Date:</strong></td><td>November 29, 2013</td></tr>
  </table>
  </div>
 <div style="clear: both;"></div>
</div>
<p>The post <a href="https://labs.portcullis.co.uk/tools/cspcalculator/">cspCalculator</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://labs.portcullis.co.uk/tools/cspcalculator/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>HTML 5 Good Practice Guide</title>
		<link>https://labs.portcullis.co.uk/whitepapers/html-5-good-practice-guide/</link>
		<comments>https://labs.portcullis.co.uk/whitepapers/html-5-good-practice-guide/#comments</comments>
		<pubDate>Fri, 26 Apr 2013 17:54:06 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Whitepapers]]></category>
		<category><![CDATA[GPG]]></category>
		<category><![CDATA[HTML5]]></category>
		<category><![CDATA[SDL]]></category>
		<category><![CDATA[training]]></category>

		<guid isPermaLink="false">http://wordpress.65535.com/blogtest/?p=106</guid>
		<description><![CDATA[<p>This document is not intended to be a definitive guide, but more of a review of the specific security issues resulting from the use of HTML 5. Portcullis was asked to provide consultancy in the form of analysis and good practice recommendations with respect to migrations from Flash to HTML 5. Whilst this document is [&#8230;]</p><p>The post <a href="https://labs.portcullis.co.uk/whitepapers/html-5-good-practice-guide/">HTML 5 Good Practice Guide</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>This document is not intended to be a definitive guide, but more of a review of the specific security issues resulting from the use of HTML 5.<span id="more-106"></span></p>
<p>Portcullis was asked to provide consultancy in the form of analysis and good practice recommendations with respect to migrations from Flash to HTML 5.</p>
<p>Whilst this document is not intended to be a definitive guide, Portcullis believes that it should provide a high level summary of the pros and cons of the proposed migration.</p>
<div class="wpfilebase-file-default" onclick="if('undefined' == typeof event.target.href) document.getElementById('wpfb-file-link-3').click();">
  <div class="icon"><a href="https://labs.portcullis.co.uk/download/HTML5GPG.pdf" target="_blank" title="Download HTML5GPG"><img align="middle" src="https://labs.portcullis.co.uk/wp-includes/images/crystal/document.png" alt="HTML5GPG" /></a></div>
  <div class="filetitle">
    <a href="https://labs.portcullis.co.uk/download/HTML5GPG.pdf" title="Download HTML5GPG.pdf" target="_blank" id="wpfb-file-link-3">HTML5GPG.pdf</a>
    
    <br />
    April 26, 2013<br />
    
  </div>
  <div class="info">
    383.1 KiB<br />
    MD5 hash: 419f5768fc2814c6e1eeaa774ba42148 <br />
    <a href="#" onclick="return wpfilebase_filedetails(3);">Details</a>
  </div>
  <div class="details" id="wpfilebase-filedetails3" style="display: none;">
  
  <table border="0">
   
   
   
   
   
   
   <tr><td><strong>Date:</strong></td><td>April 26, 2013</td></tr>
  </table>
  </div>
 <div style="clear: both;"></div>
</div>
<p>The post <a href="https://labs.portcullis.co.uk/whitepapers/html-5-good-practice-guide/">HTML 5 Good Practice Guide</a> appeared first on <a href="https://labs.portcullis.co.uk">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://labs.portcullis.co.uk/whitepapers/html-5-good-practice-guide/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
	</channel>
</rss>
