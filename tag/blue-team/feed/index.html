<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Portcullis Labs &#187; blue team</title>
	<atom:link href="https://portcullislabs.github.io/tag/blue-team/feed/" rel="self" type="application/rss+xml" />
	<link>https://portcullislabs.github.io</link>
	<description>Research and Development</description>
	<language>en-US</language>
		<sy:updatePeriod>hourly</sy:updatePeriod>
		<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=3.8.5</generator>
	<item>
		<title>So you want to build a SOC: Lessons from the front line</title>
		<link>https://portcullislabs.github.io/presentations/so-you-want-to-build-a-soc-lessons-from-the-front-line/</link>
		<comments>https://portcullislabs.github.io/presentations/so-you-want-to-build-a-soc-lessons-from-the-front-line/#comments</comments>
		<pubDate>Thu, 20 Jun 2019 14:06:57 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Presentations]]></category>
		<category><![CDATA[blue team]]></category>
		<category><![CDATA[conference]]></category>
		<category><![CDATA[SOC]]></category>
		<category><![CDATA[TTRS]]></category>

		<guid isPermaLink="false">https://portcullislabs.github.io/?p=6855</guid>
		<description><![CDATA[<p>Presentation on building an effective operational security capability (as given at Cisco Live US/Talos Threat Research Summit 2019). This talk will not help you build a SOC in only 60 minutes, but it will help you build a functional security operation over time. Building a SOC can be daunting. This talk will look at how [&#8230;]</p><p>The post <a href="https://portcullislabs.github.io/presentations/so-you-want-to-build-a-soc-lessons-from-the-front-line/">So you want to build a SOC: Lessons from the front line</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Presentation on building an effective operational security capability (as given at Cisco Live US/Talos Threat Research Summit 2019).<span id="more-6855"></span></p>
<p>This talk will not help you build a SOC in only 60 minutes, but it will help you build a functional security operation over time.</p>
<p>Building a SOC can be daunting. This talk will look at how to pick your fights and the key battles (authentication, logging, etc.) that any operational security team needs to win. The session will discuss how to ensure you formalize existing good practices and just as importantly what gaps may exist in the team’s processes. The session will look at the next steps that any organization intending to set off down this road ought to consider.</p>
<div class="wpfilebase-file-default" onclick="if('undefined' == typeof event.target.href) document.getElementById('wpfb-file-link-1').click();">
  <div class="icon"><a href="https://portcullislabs.github.io/download/TTRS19SYWTBASLFTFL.pdf" target="_blank" title="Download TTRS19SYWTBASLFTFL"><img align="middle" src="https://portcullislabs.github.io/wp-includes/images/crystal/document.png" alt="TTRS19SYWTBASLFTFL" /></a></div>
  <div class="filetitle">
    <a href="https://portcullislabs.github.io/download/TTRS19SYWTBASLFTFL.pdf" title="Download TTRS19SYWTBASLFTFL.pdf" target="_blank" id="wpfb-file-link-1">TTRS19SYWTBASLFTFL.pdf</a>
    
    <br />
    June 20, 2019<br />
    
  </div>
  <div class="info">
    1.6 MiB<br />
    MD5 hash: 9fd544a63fcac10688d82d4cec24df44 <br />
    <a href="#" onclick="return wpfilebase_filedetails(1);">Details</a>
  </div>
  <div class="details" id="wpfilebase-filedetails1" style="display: none;">
  
  <table border="0">
   
   
   
   
   
   
   <tr><td><strong>Date:</strong></td><td>June 20, 2019</td></tr>
  </table>
  </div>
 <div style="clear: both;"></div>
</div>
<p>The post <a href="https://portcullislabs.github.io/presentations/so-you-want-to-build-a-soc-lessons-from-the-front-line/">So you want to build a SOC: Lessons from the front line</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://portcullislabs.github.io/presentations/so-you-want-to-build-a-soc-lessons-from-the-front-line/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Is that really you? The importance of identity in breach response and recovery</title>
		<link>https://portcullislabs.github.io/presentations/is-that-really-you-the-importance-of-identity-in-breach-response-and-recovery/</link>
		<comments>https://portcullislabs.github.io/presentations/is-that-really-you-the-importance-of-identity-in-breach-response-and-recovery/#comments</comments>
		<pubDate>Tue, 18 Jun 2019 08:56:23 +0000</pubDate>
		<dc:creator><![CDATA[RID]]></dc:creator>
				<category><![CDATA[Presentations]]></category>
		<category><![CDATA[blue team]]></category>
		<category><![CDATA[C-Suite]]></category>
		<category><![CDATA[conference]]></category>
		<category><![CDATA[incident response]]></category>
		<category><![CDATA[InfoSec Europe]]></category>
		<category><![CDATA[zero trust]]></category>

		<guid isPermaLink="false">https://portcullislabs.github.io/?p=6848</guid>
		<description><![CDATA[<p>Presentation on Zero Trust and the importance of identity in breach response and recovery (as given at InfoSec Europe 2019 on the tech talk track). Richard Dean, Cisco&#8217;s EMEAR Head Of Security Advisory Services looks at Cisco&#8217;s approach to zero trust. This talk discusses the need to monitoring your users’ access and privileges and how [&#8230;]</p><p>The post <a href="https://portcullislabs.github.io/presentations/is-that-really-you-the-importance-of-identity-in-breach-response-and-recovery/">Is that really you? The importance of identity in breach response and recovery</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Presentation on Zero Trust and the importance of identity in breach response and recovery (as given at InfoSec Europe 2019 on the tech talk track).<span id="more-6848"></span></p>
<p><a title="Richard Dean" href="https://www.infosecurityeurope.com/en/Contributors/7884596/Richard-Dean">Richard Dean</a>, Cisco&#8217;s EMEAR Head Of Security Advisory Services looks at Cisco&#8217;s approach to zero trust. </p>
<p>This talk discusses the need to monitoring your users’ access and privileges and how securing them as they interact with the Internet is core to a Zero Trust approach to cybersecurity. Richard doesn&#8217;t just stop there though but rather moves on to look at what happens if you’re facing a deliberate attempt to steal your users’ identities in order to take advantage of these privileges? In this talk, you’ll learn how to manage identity effectively, as well as the importance of software defined networks in the drive to zero trust and rapid threat containment.</p>
<p>Learning outcomes:</p>
<ol>
<li>Learn how to manage identity and access management effectively</li>
<li>The importance of software defined networks in enabling rapid threat containment</li>
<li>The first steps an organisation should take to start on the Zero Trust journey</li>
<li>Aligning corporate and personal security practices to get better adoption from staff, identify and password management</li>
<li>The importance of Software defined networks in the drive to Zero Trust</li>
</ol>
<div class="wpfilebase-file-default" onclick="if('undefined' == typeof event.target.href) document.getElementById('wpfb-file-link-2').click();">
  <div class="icon"><a href="https://portcullislabs.github.io/download/I2019ITRYTIOIIBRR.pdf" target="_blank" title="Download I2019ITRYTIOIIBR&amp;R"><img align="middle" src="https://portcullislabs.github.io/wp-includes/images/crystal/document.png" alt="I2019ITRYTIOIIBR&amp;R" /></a></div>
  <div class="filetitle">
    <a href="https://portcullislabs.github.io/download/I2019ITRYTIOIIBRR.pdf" title="Download I2019ITRYTIOIIBRR.pdf" target="_blank" id="wpfb-file-link-2">I2019ITRYTIOIIBRR.pdf</a>
    
    <br />
    June 18, 2019<br />
    
  </div>
  <div class="info">
    1.6 MiB<br />
    MD5 hash: 14981f12020f7774971ef61b8229188a <br />
    <a href="#" onclick="return wpfilebase_filedetails(2);">Details</a>
  </div>
  <div class="details" id="wpfilebase-filedetails2" style="display: none;">
  
  <table border="0">
   
   
   
   
   
   
   <tr><td><strong>Date:</strong></td><td>June 18, 2019</td></tr>
  </table>
  </div>
 <div style="clear: both;"></div>
</div>
<p>The post <a href="https://portcullislabs.github.io/presentations/is-that-really-you-the-importance-of-identity-in-breach-response-and-recovery/">Is that really you? The importance of identity in breach response and recovery</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://portcullislabs.github.io/presentations/is-that-really-you-the-importance-of-identity-in-breach-response-and-recovery/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Discover the secrets of the SOC</title>
		<link>https://portcullislabs.github.io/presentations/discover-the-secrets-of-the-soc/</link>
		<comments>https://portcullislabs.github.io/presentations/discover-the-secrets-of-the-soc/#comments</comments>
		<pubDate>Tue, 18 Jun 2019 08:39:26 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Presentations]]></category>
		<category><![CDATA[blue team]]></category>
		<category><![CDATA[C-Suite]]></category>
		<category><![CDATA[conference]]></category>
		<category><![CDATA[InfoSec Europe]]></category>
		<category><![CDATA[SOC]]></category>

		<guid isPermaLink="false">https://portcullislabs.github.io/?p=6846</guid>
		<description><![CDATA[<p>Presentation on building effective SOCs (as given at InfoSec Europe 2019 on the interactive workshop track). Simon Crocker, Cisco&#8217;s EMEAR lead for SOC Advisory looks at what goes into making a SOC work effectively. This talk discusses the core SOC requirements around monitoring and incident response function, but also touches on some of the other [&#8230;]</p><p>The post <a href="https://portcullislabs.github.io/presentations/discover-the-secrets-of-the-soc/">Discover the secrets of the SOC</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Presentation on building effective SOCs (as given at InfoSec Europe 2019 on the interactive workshop track).<span id="more-6846"></span></p>
<p><a title="Simon Crocker" href="https://www.infosecurityeurope.com/en/Contributors/7928410/Simon-Crocker">Simon Crocker</a>, Cisco&#8217;s EMEAR lead for SOC Advisory looks at what goes into making a SOC work effectively. </p>
<p>This talk discusses the core SOC requirements around monitoring and incident response function, but also touches on some of the other services that SOCs can also provide.</p>
<p>Learning outcomes:</p>
<ol>
<li>The challenges that SOCs face and approaches to overcome them</li>
<li>The array of services that SOCs provide</li>
<li>The roadmap to build a SOC</li>
<li>Learn how to threat hunt proactively to root out hidden threats</li>
<li>Discover best practice on threat hunting from the largest non government threat intelligence team</li>
</ol>
<div class="wpfilebase-file-default" onclick="if('undefined' == typeof event.target.href) document.getElementById('wpfb-file-link-3').click();">
  <div class="icon"><a href="https://portcullislabs.github.io/download/I2019DTSOTC.pdf" target="_blank" title="Download I2019DTSOTC"><img align="middle" src="https://portcullislabs.github.io/wp-includes/images/crystal/document.png" alt="I2019DTSOTC" /></a></div>
  <div class="filetitle">
    <a href="https://portcullislabs.github.io/download/I2019DTSOTC.pdf" title="Download I2019DTSOTC.pdf" target="_blank" id="wpfb-file-link-3">I2019DTSOTC.pdf</a>
    
    <br />
    June 18, 2019<br />
    
  </div>
  <div class="info">
    925.6 KiB<br />
    MD5 hash: 904adc3b1b54f73227ad53807bac5004 <br />
    <a href="#" onclick="return wpfilebase_filedetails(3);">Details</a>
  </div>
  <div class="details" id="wpfilebase-filedetails3" style="display: none;">
  
  <table border="0">
   
   
   
   
   
   
   <tr><td><strong>Date:</strong></td><td>June 18, 2019</td></tr>
  </table>
  </div>
 <div style="clear: both;"></div>
</div>
<p>The post <a href="https://portcullislabs.github.io/presentations/discover-the-secrets-of-the-soc/">Discover the secrets of the SOC</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://portcullislabs.github.io/presentations/discover-the-secrets-of-the-soc/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>An offensive introduction to Active Directory on UNIX</title>
		<link>https://portcullislabs.github.io/blog/an-offensive-introduction-to-active-directory-on-unix/</link>
		<comments>https://portcullislabs.github.io/blog/an-offensive-introduction-to-active-directory-on-unix/#comments</comments>
		<pubDate>Thu, 06 Dec 2018 09:18:36 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[analysis]]></category>
		<category><![CDATA[auditing]]></category>
		<category><![CDATA[Black Hat Europe]]></category>
		<category><![CDATA[blue team]]></category>
		<category><![CDATA[conference]]></category>
		<category><![CDATA[exploit]]></category>
		<category><![CDATA[hardening]]></category>
		<category><![CDATA[red team]]></category>
		<category><![CDATA[root]]></category>
		<category><![CDATA[training]]></category>
		<category><![CDATA[UNIX]]></category>
		<category><![CDATA[Windows]]></category>

		<guid isPermaLink="false">https://portcullislabs.github.io/?p=6805</guid>
		<description><![CDATA[<p>By way of an introduction to our talk at Black Hat Europe, Security Advisory EMEAR would like to share the background on our recent research into some common Active Directory integration solutions. Just as with Windows, these solutions can be utilized to join UNIX infrastructure to enterprises&#8217; Active Directory forests. Background to Active Directory integration [&#8230;]</p><p>The post <a href="https://portcullislabs.github.io/blog/an-offensive-introduction-to-active-directory-on-unix/">An offensive introduction to Active Directory on UNIX</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>By way of an introduction to <a href="https://www.blackhat.com/eu-18/briefings/schedule/index.html#where-2-worlds-collide-bringing-mimikatz-et-al-to-unix-12962" title="our talk">our talk</a> at Black Hat Europe, <a href="https://www.cisco.com/c/en/us/products/security/advisory-services.html" title="Security Advisory EMEAR">Security Advisory EMEAR</a> would like to share the background on our recent research into some common Active Directory integration solutions. Just as with Windows, these solutions can be utilized to join UNIX infrastructure to enterprises&#8217; Active Directory forests.<span id="more-6805"></span></p>
<h2>Background to Active Directory integration solutions</h2>
<p>Having seen an uptick in unique UNIX infrastructures that are integrated into customers&#8217; existing Active Directory forests, the question becomes, &#8220;Does this present any concerns that may not be well understood?&#8221; This quickly became &#8220;What if an adversary could get into a UNIX box and then breach your domain?&#8221;<br />
Within a typical Active Directory integration solution (in this case <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/5/html/5.7_release_notes/sssd" title="SSSD">SSSD</a>), the solution shares a striking similarity to what a user might see on Windows. Notably, you have:</p>
<ul>
<li>DNS &#8211; Used for name resolution</li>
<li>LDAP &#8211; Used for &#8220;one-time identification&#8221; and assertion of identity</li>
<li>Kerberos &#8211; Used for ongoing authentication</li>
<li>SSSD &#8211; Like LSASS</li>
<li>PAM &#8211; Like msgina.dll or the more modern credential providers</li>
</ul>
<p>You can see a breakdown of this process <a title="here" href="https://rhelblog.redhat.com/2015/02/04/overview-of-direct-integration-options/">here</a>. Unlike Windows, there is no Group Policy for the most part (with some exceptions), so policies for sudo et al. are typically pushed as flat files to hosts.</p>
<h2>Our research</h2>
<p>Realistically, the threat models associated with each part of the implementation should be quite familiar to anyone securing a heterogeneous Windows network. Having worked with a variety of customers, it becomes apparent that the typical UNIX administrator who does not have a strong background in Windows and Active Directory will be ill-equipped to handle this threat. While we&#8217;ve been talking about successful attacks against components such as LSASS and Kerberos for quite some time, Mimikatz dates back to at least April 2014, and dumping hashes has been around even longer. Pwdump, which dumped local Windows hashes, was published by Jeremy Allison in 1997). However, no one has really taken a concerted look at whether these attacks are possible on UNIX infrastructure, nor how a blue team might spot an adversary performing them.</p>
<p>As a result of this research, we were able to develop tactics, tools, and procedures that might further assist an attacker in breaching an enterprise, and we began documenting and developing appropriate strategies to allow blue teams to appropriately detect and respond to such incursions. The Black Hat EU slides can be found <a title="here" href="/presentations/where-2-worlds-collide-bringing-mimikatz-et-al-to-unix/">here</a> and whilst the tools we developed can be found on <a href="https://github.com/portcullislabs/linikatz" title="our GitHub repo">our GitHub repo</a>.</p>
<p>The post <a href="https://portcullislabs.github.io/blog/an-offensive-introduction-to-active-directory-on-unix/">An offensive introduction to Active Directory on UNIX</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://portcullislabs.github.io/blog/an-offensive-introduction-to-active-directory-on-unix/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Where 2 worlds collide: Bringing Mimikatz et al to UNIX</title>
		<link>https://portcullislabs.github.io/presentations/where-2-worlds-collide-bringing-mimikatz-et-al-to-unix/</link>
		<comments>https://portcullislabs.github.io/presentations/where-2-worlds-collide-bringing-mimikatz-et-al-to-unix/#comments</comments>
		<pubDate>Thu, 06 Dec 2018 08:04:06 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Presentations]]></category>
		<category><![CDATA[analysis]]></category>
		<category><![CDATA[auditing]]></category>
		<category><![CDATA[Black Hat Europe]]></category>
		<category><![CDATA[blue team]]></category>
		<category><![CDATA[conference]]></category>
		<category><![CDATA[exploit]]></category>
		<category><![CDATA[hardening]]></category>
		<category><![CDATA[red team]]></category>
		<category><![CDATA[root]]></category>
		<category><![CDATA[training]]></category>
		<category><![CDATA[UNIX]]></category>
		<category><![CDATA[Windows]]></category>

		<guid isPermaLink="false">https://portcullislabs.github.io/?p=6806</guid>
		<description><![CDATA[<p>Presentation on Active Directory integration solutions for UNIX (as given at Black Hat Europe 2018). Over the past fifteen years there&#8217;s been an uptick in &#8220;interesting&#8221; UNIX infrastructures being integrated into customers&#8217; existing AD forests. Whilst the threat models enabled by this should be quite familiar to anyone securing a heterogeneous Windows network, they may [&#8230;]</p><p>The post <a href="https://portcullislabs.github.io/presentations/where-2-worlds-collide-bringing-mimikatz-et-al-to-unix/">Where 2 worlds collide: Bringing Mimikatz et al to UNIX</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Presentation on Active Directory integration solutions for UNIX (as given at Black Hat Europe 2018).<span id="more-6806"></span></p>
<p>Over the past fifteen years there&#8217;s been an uptick in &#8220;interesting&#8221; UNIX infrastructures being integrated into customers&#8217; existing AD forests. Whilst the threat models enabled by this should be quite familiar to anyone securing a heterogeneous Windows network, they may not be as well understood by a typical UNIX admin who does not have a strong background in Windows and AD. Over the last few months we&#8217;ve spent some time looking a number of specific Active Directory integration solutions (both open and closed source) for UNIX systems and documenting some of the tools, tactics and procedures that enable attacks on the forest to be staged from UNIX.</p>
<p>This talk describes the technical details regarding our findings. It includes Proof of Concepts (PoC) showing real-world attacks against AD joined UNIX systems. Finally, potential solutions or mitigation controls are discussed that will help to either prevent those attacks or at the very least to detect them when they occur.</p>
<p>Tools referenced in this talk include:</p>
<ul>
<li><a href="https://github.com/portcullislabs/linikatz" title="Linikatz">Linikatz</a></li>
<ul>
<li><a href="https://github.com/portcullislabs/linikatz/tree/master/red/JohnTheRipper" title="JohnTheRipper dynamic.conf rules">JohnTheRipper dynamic.conf rules</a></li>
<li><a href="https://github.com/portcullislabs/linikatz/tree/master/red/metasploit-framework" title="metasploit-framework post-exploitation modules">metasploit-framework post-exploitation modules</a></li>
<li><a href="https://github.com/portcullislabs/linikatz/tree/master/blue/audit" title="auditd policies">auditd policies</a></li>
<li><a href="https://github.com/portcullislabs/linikatz/tree/master/tools/vas/fuzzers" title="fuzzers">fuzzers</a></li>
</ul>
</ul>
<div class="wpfilebase-file-default" onclick="if('undefined' == typeof event.target.href) document.getElementById('wpfb-file-link-4').click();">
  <div class="icon"><a href="https://portcullislabs.github.io/download/eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf" target="_blank" title="Download Eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX"><img align="middle" src="https://portcullislabs.github.io/wp-includes/images/crystal/document.png" alt="Eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX" /></a></div>
  <div class="filetitle">
    <a href="https://portcullislabs.github.io/download/eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf" title="Download eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf" target="_blank" id="wpfb-file-link-4">eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf</a>
    
    <br />
    December 6, 2018<br />
    
  </div>
  <div class="info">
    724.9 KiB<br />
    MD5 hash: cc712c5e46b16fbff22a2566b1248a91 <br />
    <a href="#" onclick="return wpfilebase_filedetails(4);">Details</a>
  </div>
  <div class="details" id="wpfilebase-filedetails4" style="display: none;">
  
  <table border="0">
   
   
   
   
   
   
   <tr><td><strong>Date:</strong></td><td>December 6, 2018</td></tr>
  </table>
  </div>
 <div style="clear: both;"></div>
</div>
<p>The post <a href="https://portcullislabs.github.io/presentations/where-2-worlds-collide-bringing-mimikatz-et-al-to-unix/">Where 2 worlds collide: Bringing Mimikatz et al to UNIX</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://portcullislabs.github.io/presentations/where-2-worlds-collide-bringing-mimikatz-et-al-to-unix/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>The importance of logs: You won&#8217;t see what you don&#8217;t log</title>
		<link>https://portcullislabs.github.io/presentations/the-importance-of-logs-you-wont-see-what-you-dont-log/</link>
		<comments>https://portcullislabs.github.io/presentations/the-importance-of-logs-you-wont-see-what-you-dont-log/#comments</comments>
		<pubDate>Wed, 31 Oct 2018 12:36:40 +0000</pubDate>
		<dc:creator><![CDATA[TMB]]></dc:creator>
				<category><![CDATA[Presentations]]></category>
		<category><![CDATA[blue team]]></category>
		<category><![CDATA[hardening]]></category>
		<category><![CDATA[red team]]></category>
		<category><![CDATA[SecureSouthWest]]></category>
		<category><![CDATA[training]]></category>

		<guid isPermaLink="false">https://portcullislabs.github.io/?p=6793</guid>
		<description><![CDATA[<p>Presentation on logging and auditing strategies (as given at Secure South West 11). Building on my blog post on Cisco&#8217;s security blog entitled The Importance of Logs, I put together a presentation that picks apart some of the practical aspects of building a successful logging capability focusing on the need to document &#8220;good&#8221; and curate [&#8230;]</p><p>The post <a href="https://portcullislabs.github.io/presentations/the-importance-of-logs-you-wont-see-what-you-dont-log/">The importance of logs: You won&#8217;t see what you don&#8217;t log</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Presentation on logging and auditing strategies (as given at Secure South West 11).<span id="more-6793"></span></p>
<p>Building on my blog post on Cisco&#8217;s security blog entitled <a href="https://blogs.cisco.com/security/the-importance-of-logs">The Importance of Logs</a>, I put together a presentation that picks apart some of the practical aspects of building a successful logging capability focusing on the need to document &#8220;good&#8221; and curate &#8220;bad&#8221;.</p>
<p>The purpose of this talk is not to help you build a SOC in 30 minutes, rather it looks at how logging can go wrong and how to plan in order to get it right. The talk includes some composite case studies which highlight some of the challenges that we&#8217;ve seen over the years (particularly when responding in customer breaches) and makes some suggestions on where interested organisations should focus their efforts next.</p>
<div class="wpfilebase-file-default" onclick="if('undefined' == typeof event.target.href) document.getElementById('wpfb-file-link-5').click();">
  <div class="icon"><a href="https://portcullislabs.github.io/download/SSWTIOLYWSWYDL.pdf" target="_blank" title="Download SSWTIOLYWSWYDL"><img align="middle" src="https://portcullislabs.github.io/wp-includes/images/crystal/document.png" alt="SSWTIOLYWSWYDL" /></a></div>
  <div class="filetitle">
    <a href="https://portcullislabs.github.io/download/SSWTIOLYWSWYDL.pdf" title="Download SSWTIOLYWSWYDL.pdf" target="_blank" id="wpfb-file-link-5">SSWTIOLYWSWYDL.pdf</a>
    
    <br />
    October 31, 2018<br />
    
  </div>
  <div class="info">
    463.7 KiB<br />
    MD5 hash: 390c1d8b29e74f2c15df434b4d0d9f99 <br />
    <a href="#" onclick="return wpfilebase_filedetails(5);">Details</a>
  </div>
  <div class="details" id="wpfilebase-filedetails5" style="display: none;">
  
  <table border="0">
   
   
   
   
   
   
   <tr><td><strong>Date:</strong></td><td>October 31, 2018</td></tr>
  </table>
  </div>
 <div style="clear: both;"></div>
</div>
<p>The post <a href="https://portcullislabs.github.io/presentations/the-importance-of-logs-you-wont-see-what-you-dont-log/">The importance of logs: You won&#8217;t see what you don&#8217;t log</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://portcullislabs.github.io/presentations/the-importance-of-logs-you-wont-see-what-you-dont-log/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Windows 10’s &#8220;Controlled Folder Access&#8221; feature</title>
		<link>https://portcullislabs.github.io/blog/windows-10s-controlled-folder-access-feature/</link>
		<comments>https://portcullislabs.github.io/blog/windows-10s-controlled-folder-access-feature/#comments</comments>
		<pubDate>Thu, 16 Nov 2017 09:44:52 +0000</pubDate>
		<dc:creator><![CDATA[RGH]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[auditing]]></category>
		<category><![CDATA[blue team]]></category>
		<category><![CDATA[red team]]></category>
		<category><![CDATA[training]]></category>
		<category><![CDATA[Windows]]></category>

		<guid isPermaLink="false">https://portcullislabs.github.io/?p=6110</guid>
		<description><![CDATA[<p>Microsoft released a rolling upgrade of Windows 10 in October 2017. The &#8220;Fall Creators&#8221; edition (version 1709, codename Redstone 3) contains a new feature called &#8220;Controlled Folder Access&#8221;, which is designed to combat ransomware attacks. Controlled Folder Access is part of Windows Defender Security Centre that works with Windows Defender Anti-Virus to prevent &#8220;suspicious&#8221; executable [&#8230;]</p><p>The post <a href="https://portcullislabs.github.io/blog/windows-10s-controlled-folder-access-feature/">Windows 10’s &#8220;Controlled Folder Access&#8221; feature</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Microsoft released a rolling upgrade of Windows 10 in October 2017. The &#8220;Fall Creators&#8221; edition (version 1709, codename Redstone 3) contains a new feature called &#8220;Controlled Folder Access&#8221;, which is designed to combat ransomware attacks.<span id="more-6110"></span></p>
<p>Controlled Folder Access is part of Windows Defender Security Centre that works with Windows Defender Anti-Virus to prevent &#8220;suspicious&#8221; executable files, DLLs, and scripts from writing to (or encrypting) files within certain folders.</p>
<h2>What folders are protected?</h2>
<p>While additional folders can be added, the following locations will always be monitored when Controlled Folder Access is enabled:</p>
<ul>
<li>User: Documents, Pictures, Videos, Music, Desktop, Favorites</li>
<li>Public: Documents, Pictures, Videos, Music, Desktop</li>
</ul>
<h2>How does Windows determine what `suspicious&#8217; code is?</h2>
<p>It’s what Windows Defender Anti-Virus identifies. As such Controlled Folder Access relies on Windows Defender Anti-Virus to be running.</p>
<h2>What about application false positives?</h2>
<p>It may be the case that legitimate applications are incorrectly flagged by Windows Defender Anti-Virus as being `suspicious&#8217; preventing or hindering legitimate use. Such applications can be white-listed.</p>
<p>To facilitate this, Controlled Folder Access supports an `audit&#8217; mode, where an event is generated when the application would normally be prevented from writing to a protected folder. Those events can be reviewed to identify legitimate applications that can be added to the white-list.</p>
<h2>Is Controlled Folder Access enabled by default? How do I configure it?</h2>
<p>Controlled Folder Access is not enabled by default and can be configured via:</p>
<ul>
<li>The User Interface</li>
<li>Group Policy (a Group Policy would need to be configured on a system that contains the correct administrative templates for the options to be available for selection): Computer Configuration > Administrative Templates > Windows Components > Windows Defender Anti-Virus > Windows Defender Exploit Guard > Controlled Folder Access</li>
<li>Manual Registry modification (i.e. via a script)</li>
<li>PowerShell cmdlets:</li>
</ul>
<pre class="brush: powershell; gutter: false; title: ; notranslate">
Set-MpPreference -EnableControlledFolderAccess [Enable | Disable | Audit]
Add-MpPreference -ControlledFolderAccessProtectedFolders c:\path\to\protect,c:\other\path
Remove-MpPreference -ControlledFolderAccessProtectedFolders c:\path\to\no\longer\protect
</pre>
<p>Note: Set-MpPreference can also be used to specify folder items but will clear the list first, whereas Add-MpPreference adds to the list.</p>
<h2>What Registry keys are used by Controlled Folder Access?</h2>
<h3>Is Controlled Folder Access enabled?</h3>
<pre class="brush: bash; gutter: false; title: ; notranslate">
Registry path: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Defender\Exploit Guard\Controlled Folder Access
Registry Key: GuardMyFolders
Key Type: REG_DWORD
Key Value: 0
</pre>
<h3>Protected Folders</h3>
<pre class="brush: bash; gutter: false; title: ; notranslate">
Registry path: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Defender\Exploit Guard\Controlled Folder Access\ProtectedFolders
Registry Key: audit
Key Type: REG_DWORD
Key Value: 0
</pre>
<h3>To specify protected folders:</h3>
<pre class="brush: bash; gutter: false; title: ; notranslate">
Registry path: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Defender\Exploit Guard\Controlled Folder Access\ProtectedFolders
Registry Key: Full path to protect, i.e. c:\test
Key Type: REG_DWORD
Key Value: 0&lt;/code&gt;
</pre>
<h2>What can be protected? Any limitations?</h2>
<p>Network shares and mapped drives can be protected, but Controlled Folder Access does not support the use of:</p>
<ul>
<li>Environment Variables</li>
<li>Wildcards</li>
<li>The Windows drive (typically C:\)</li>
</ul>
<p>Seriously, don’t protect the entire Windows drive as Windows will be unable to function correctly and strange behaviour will result.</p>
<h3>What happens when write access is blocked?</h3>
<p>A notification is displayed that provides the path of the executable that was blocked, and the path of protected folder that the write attempt was for. This information is also recorded in the event log, using the following event values:</p>
<ul>
<li>Event ID: 5007: Event when settings are changed</li>
<li>Event ID: 1124: Audited Controlled folder access event</li>
<li>Event ID: 1123: Blocked Controlled folder access event</li>
</ul>
<p>The following image shows the notification of a write action being blocked:</p>
<p><a name="imageclose-6111"><div class="lb-album"><a href="#image-6111"><img src="https://portcullislabs.github.io/wp-content/uploads/2017/11/VirtualBox_Win10_Ent_90days_02_11_2017_14_17_19-300x225.png" alt="Blocked write access notification" class="size-medium wp-image-6121"><span></span></a></div>              
<a href="#imageclose-6111" class="css3lightbox-close">
				   <div class="lb-overlay" id="image-6111">
                   <img src="https://portcullislabs.github.io/wp-content/uploads/2017/11/VirtualBox_Win10_Ent_90days_02_11_2017_14_17_19.png" alt="image-6111">
                   </div></a></p>
<h3>Can the blocked write notification message be customised?</h3>
<p>Yes, at least for Enterprise environments. Providing details of who to contact (service desk, IT Security, etc.) can be included in the notification message via the following Group Policy settings:</p>
<pre class="brush: bash; gutter: false; title: ; notranslate">
Computer Configuration &gt; Policies &gt; Adminstrative Templates &gt; Windows Components &gt; Windows Defender Security Center &gt; Enterprise Customization
</pre>
<ul>
<li> Set &#8220;Configure customized contact information&#8221; to &#8220;Enabled&#8221;</li>
<li> Set &#8220;Configure customized notifications&#8221; to &#8220;Enabled&#8221;</li>
<li> Set &#8220;Specify contact compant name&#8221; to &#8220;Enabled&#8221; and add the company details</li>
<li> Enable and set at least one of the following:
<ul>
<li>&#8220;Specify contact email address or EmailID&#8221;</li>
<li>&#8220;Specify contact phone number or Skype ID&#8221;</li>
<li>&#8220;Specify contact web site&#8221;</li>
</ul>
</li>
</ul>
<h3>Does Controlled Folder Access work with third-party Anti-Virus applications?</h3>
<p>No, or at least not in the tests performed when writing this post. Controlled Folder Access requires the use of Windows Defender Anti-Virus to be active.</p>
<p>Most third-party Anti-Virus solutions replace existing products, and attempting to run multiple Anti-Virus solutions at the same time can significantly hinder system performance, or even lead to each one preventing the other from being able to scan files or removable drives which could lower protections. One Anti-Virus program might flag others as being infected (i.e. triggering on the detection patterns) or malicious, and quarantine key files – potentially breaking that product.</p>
<h3>How can I tell Controlled Folder Access and Notifications are configured and working?</h3>
<p>Microsoft have produced an ExploitGuard CFA File Creator tool to trigger Controlled Folder Access actions, which causes notifications to be displayed.</p>
<p>Details on the <a href="https://docs.microsoft.com/en-us/windows/threat-protection/windows-defender-exploit-guard/evaluate-controlled-folder-access#use-the-demo-tool-to-see-how-controlled-folder-access-works" title="ExploitGuard CFA Demo Tool">ExploitGuard CFA Demo Tool</a>, and a link to download it, can be found on Microsoft&#8217;s web site.</p>
<h2>Conclusion</h2>
<p>For home users or business that do not have a corporate Anti-Virus solution, Windows Defender Anti-Virus and Controlled Folder Access will be better than nothing.<br />
However, larger businesses typically have existing enterprise-wide Anti-Virus solutions in which significant time and effort (and money) has been invested. It would be difficult to convince the IT Security teams of such companies to throw out that investment, so I don’t expect Controlled Folder Access to be used much in large businesses.</p>
<p>Controlled Folder Access is a new feature, and it may be that Microsoft modify it to work with third-party Anti-Virus products in the future.</p>
<p>The post <a href="https://portcullislabs.github.io/blog/windows-10s-controlled-folder-access-feature/">Windows 10’s &#8220;Controlled Folder Access&#8221; feature</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://portcullislabs.github.io/blog/windows-10s-controlled-folder-access-feature/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Hindering Lateral Movement</title>
		<link>https://portcullislabs.github.io/blog/hindering-lateral-movement/</link>
		<comments>https://portcullislabs.github.io/blog/hindering-lateral-movement/#comments</comments>
		<pubDate>Fri, 27 Oct 2017 12:53:52 +0000</pubDate>
		<dc:creator><![CDATA[RGH]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[auditing]]></category>
		<category><![CDATA[blue team]]></category>
		<category><![CDATA[red team]]></category>
		<category><![CDATA[training]]></category>
		<category><![CDATA[Windows]]></category>

		<guid isPermaLink="false">https://portcullislabs.github.io/?p=6092</guid>
		<description><![CDATA[<p>Lateral Movement is a method used by attackers (or malware) against a network Domain. After an initial device is compromised (typically, a user&#8217;s workstation), the attacker extracts passwords from memory, or obtains encrypted password hashes from the system for cracking or direct use (i.e. Pass the Hash). The attacker then attempts to login to other [&#8230;]</p><p>The post <a href="https://portcullislabs.github.io/blog/hindering-lateral-movement/">Hindering Lateral Movement</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>Lateral Movement is a method used by attackers (or malware) against a network Domain. After an initial device is compromised (typically, a user&#8217;s workstation), the attacker extracts passwords from memory, or obtains encrypted password hashes from the system for cracking or direct use (i.e. Pass the Hash). The attacker then attempts to login to other systems using those credentials to search for cached passwords of privileged Domain accounts. Usually, the local Administrator account is targeted as the password is often the same on all systems (due to the common practice of deploying systems from a master image), but service accounts, etc. can also be targeted.<span id="more-6092"></span></p>
<p>In some cases, an attacker is able to move from having local Administrator access on a workstation to gaining full Domain Admin rights on the Domain in under an hour.</p>
<p>Since Active Directory typically controls access to highly sensitive information, it is important to try and prevent lateral attacks from working. Being able to spot these attacks would also be good.</p>
<h2>Limit workstation to workstation communications</h2>
<p>It is highly unusual for network users to need to directly communicate with other users’ workstations.</p>
<p>Configure each workstation to use a local firewall to block incoming Windows network traffic (139/TCP, 445/TCP and 137/UDP) from any workstation subnet. </p>
<p>If using a firewall that supports different network zones (such as the Windows Firewall), ensure the appropriate zone profiles are configured, or simply configure all profiles. If your organisation uses VoIP telephones, prevent those subnets from connecting as well to protect against either a malicious internal employee, or in case the attacker is able to convince a user to try changing network connections.</p>
<h2>Prevent local users from logging in over the network</h2>
<p>If an attacker finds that they cannot directly connect to other workstations to hunt for privileged cached credentials, they may attempt to compromise a server and try to login to workstations from there. To protect against this, configure the User Rights policy &#8216;Deny access to this computer from the network&#8217; by adding local user accounts.</p>
<h2>Use a local Administrator password management tool</h2>
<p>Tools, such as Microsoft LAPS, exist that set unique passwords for the local administrator account. By using such tools, when a password exceeds its expiration date the password will be changed automatically when the Group Policy is refreshed. Avoid writing a custom password management system, as it is very difficult to implement such things without error; if an attacker is able to determine a pattern to setting the password, then that defence is gone.</p>
<h2>Configure systems via Group Policy</h2>
<p>To reduce the risk of credentials being captured, avoid logging into systems where not necessary. Use Group Policies to configure workstations and servers instead of directly logging into them, where possible. Systems may be configured to cache credentials when users login, and this information can be obtained by an attacker and then cracked offline to reveal the plain text password for that user account. If an attacker already has a foothold on a system and a Domain Administrator logs in, the attacker may be able to impersonate the Domain Administrator in order to utilise their privileges within the network Domain.</p>
<h2>Use dedicated administrative accounts and workstations</h2>
<p>An attacker can only extract privileged password data if it is present on the system. Ensure administrative users have user accounts that are separate from their day-to-day user accounts and configure them so that they cannot login to normal workstations or servers; they should only be used to login to Active Directory servers to manage them, and configure Group Policies to manage other systems.</p>
<p>Dedicated management workstations should not be able to access the Internet or email.</p>
<h2>Disable &#8216;WDigest&#8217;</h2>
<p>Windows supports several Security Support Providers (SSPs), used to handle authentication requests (including Single Sign On). Until recently (Window 8.1 and Server 2012 R2 or higher), Windows used by default an SSP called &#8216;WDigest&#8217; &#8211; which stored user credentials in plain text in memory, allowing a process with local Administrator privileges to extract the passwords of all logged-in users.</p>
<p>To help address this issue, Microsoft created a new Registry key for &#8216;WDigest&#8217; to disable storing plain text passwords, which can be applied to Windows, prior to 8.1 and Server 2012 R2 by installing KB2871997 and configuring the following Registry setting:</p>
<pre class="brush: bash; gutter: false; title: ; notranslate">
Registry Path: HKLM\System\CurrentControlSet\Control\SecurityProviders\Wdigest
Key Name: UseLogonCredential
Key Type: REG_DWORD
Key Value: 0
</pre>
<p>Alternatively, KB2871997 can be configured via Group Policy by installing the PtH.admx/adml files provided with the Microsoft Security Compliance Manager (SCM) via:</p>
<pre class="brush: bash; gutter: false; title: ; notranslate">
Local Policies &gt; Administrative Templates &gt; SCM: Pass the Hash Mitigations &gt; Wdigest Authentication
</pre>
<h2>Apply enhanced credentials protection updates</h2>
<p>In addition to the protections added by KB2871997, Microsoft have released an updated that further protects against Pass the Hash (PtH) attacks for Windows 7, Windows 8, Server 2008 R2 and Server 2012. </p>
<h2>KB3126593 (MS16-014)</h2>
<p>This update adds support for the TokenLeakDetectDelaySecs Registry setting which can be used to force credentials to be cleared after a user logs off. To set clearing credentials 30 seconds after user logout (the default behaviour in Windows 8.1 and Windows 10), configure the following Registry setting:</p>
<pre class="brush: bash; gutter: false; title: ; notranslate">
Registry Path: HKLM\System\CurrentControlSet\Control\Lsa
Key Name: TokenLeakDetectDelaySecs
Key Type: REG_DWORD
Key Value: 30
</pre>
<h2>Upgrade Windows servers and workstations</h2>
<p>With each new version of Windows, Microsoft adds additional security features, including protections for the LSASS service to protect against credential stealing and adding additional logging options. Upgrade servers to Server 2016 and upgrade workstations to Windows 10 and configure them to make use of these new features. </p>
<h2>Enable event monitoring and investigate alerts</h2>
<p>A centralised logging and monitoring solution provides an opportunity for recording actions and events that take place on systems, and prevents a successful attacker from clearing the event log to hide their actions.</p>
<p>Configure all Windows systems to log events to a centralised system and monitor for account login attempts (both successful and unsuccessful).<br />
Any events that reference local accounts (or Domain Administrator/privileged accounts) and not Domain accounts should be investigated as a matter of priority. </p>
<p>The following Windows event codes are generated by Windows 2008 and later:</p>
<ul>
<li>Event ID: 4624: Account login successful</li>
<li>Event ID: 4625: Account login failed</li>
</ul>
<p>The corresponding events for Windows 2003 and earlier:</p>
<ul>
<li>Event ID: 528: Account login successful</li>
<li>Event ID: 540: Network account login successful</li>
<li>Event ID: 529: Login failure &#8211; Unknown user or bad password</li>
</ul>
<p>Other potentially interesting event code are:</p>
<ul>
<li>Event ID: 4625: An account failed to login (Windows 2008 and later)</li>
<li>Event ID: 531: Login failure &#8211; Account currently disabled (Windows 2003 and earlier)</li>
</ul>
<h2>Conclusion</h2>
<p>A number of options have been presented to hinder Lateral Movement attacks, and some readers might be wondering which option to implement. The answer is &#8220;all of them, where possible&#8221;. Security is a &#8220;defence in depth&#8221; game, and every obstacle that an attacker has to work around is worth implementing.</p>
<p>In addition to hindering lateral movement, monitoring for attacks or suspicious behaviour and investigating alerts will help identify more sophisticated attacks, as well as indicating that suspicious activities are occurring.</p>
<p>A <a href="https://blogs.cisco.com/security/can-your-organisation-be-breached-find-out-with-a-red-team" title="Red Team">Red Team Assessment</a> can be undertaken to determine the effectiveness of the security controls in place during an attack against your network. Whilst the assessment is taking place it also provides an opportunity to determine whether the internal monitoring and response capabilities intended to detect and alert when a potential attack is occurring within your network are effective. Following completion of the assessment you will have a clear view of any additional measures that should be implemented to improve both defence and monitoring capabilities within your network.</p>
<p>The post <a href="https://portcullislabs.github.io/blog/hindering-lateral-movement/">Hindering Lateral Movement</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://portcullislabs.github.io/blog/hindering-lateral-movement/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>A study in scarlet</title>
		<link>https://portcullislabs.github.io/blog/a-study-in-scarlet/</link>
		<comments>https://portcullislabs.github.io/blog/a-study-in-scarlet/#comments</comments>
		<pubDate>Thu, 20 Jul 2017 12:28:58 +0000</pubDate>
		<dc:creator><![CDATA[TDR]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[analysis]]></category>
		<category><![CDATA[blue team]]></category>
		<category><![CDATA[phishing]]></category>
		<category><![CDATA[red team]]></category>

		<guid isPermaLink="false">https://portcullislabs.github.io/?p=5917</guid>
		<description><![CDATA[<p>In the modern age, where computers are used for nearly everything we do, the damage that can be caused to a company by cyber-attacks is substantial, with companies losing millions in regulatory fines, compensation and declining share prices. While some of these breaches have been caused by vulnerabilities within the target company&#8217;s infrastructure/software, a large [&#8230;]</p><p>The post <a href="https://portcullislabs.github.io/blog/a-study-in-scarlet/">A study in scarlet</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>In the modern age, where computers are used for nearly everything we do, the damage that can be caused to a company by cyber-attacks is substantial, with companies losing millions in regulatory fines, compensation and declining share prices. While some of these breaches have been caused by vulnerabilities within the target company&#8217;s infrastructure/software, a large quantity of them began with a phishing attack.<span id="more-5917"></span></p>
<p>Generally speaking, phishing is a social engineering technique that involves sending fraudulent emails to individuals in an attempt to coerce them into providing confidential information or network access. Spear phishing is a more targeted form of this, where attackers will target specific individuals within an organisation and use information gathered from publicly available resources, such as social media, to make the malicious emails seem more genuine. This attack technique is very effective, with previous research showing victims being up to 4.5 times more likely to believe the contents of targeted emails. Additionally, targeting specific individuals with more access within an organisation, such as managers or system administrators, gives the attacker a greater chance of finding sensitive information than that provided by standard phishing.</p>
<p>The best defence against phishing attacks is to have employees that are aware of the threat and the methods of identifying them. That being said, it&#8217;s important to support your employees in this effort, minimising risk and the potential for human error, which is why employers should be doing everything they can to ensure that the emails do not reach their targets and, when they do, that they are easy to identify and report. This can be achieved by looking at the cyber kill chain, as documented by Lockheed Martin, and implementing sensible security controls at each of the stages that relate specifically to a phishing attack.</p>
<h2>Delivery</h2>
<p>The first part of the cyber kill chain where we can actively identify these attacks is at the delivery stage &#8211; when a malicious email hits the external mail server of an organisation. The following security controls can be put in place at this stage of an attack to identify and mitigate the majority of phishing attacks.</p>
<h3>Mail content scanning</h3>
<p>The most obvious place to search for indicators of a phishing attempt is the content of the emails themselves. By analysing information gathered about common attacks used by malicious actors, it is possible to identify potential phishing attacks before they reach the intended target. The contents of these emails can then be modified to make it easier for users to identify them.</p>
<p>As attackers use phishing as a method of gaining unauthorised access to systems or data, a common attack vector is to include a hyperlink to a web application that they control. Modern mail clients capable of rendering HTML emails make this attack method even more effective, as attackers are able to change the text that is displayed to the user in place of the hyperlink. To help the user identify the threat and limit the risk of this method of attack, hyperlinks should be rewritten to display to the user where their browser will take them if they click on the link.</p>
<p>As phishing attempts will generally come from a network location external to their intended targets, another very simple but effective method of improving a user&#8217;s likelihood of identifying a phishing attack is the addition of a warning to the email, stating that it is from an external user. Users seeing that emails have come from an external location are much more likely to exercise caution when following hyperlinks.</p>
<h3>Attachments</h3>
<p>Malicious attachments sent via phishing email are a very real and dangerous threat as, at worst, they could allow an attacker to bypass all external protections and provide them with direct access to a company&#8217;s internal network. The most secure method to avoid the risk of this threat would be to block all email attachments coming into a company, however, for the majority of businesses this is not practical and would severely limit their ability to communicate with clients/third-parties. The following security controls can help to mitigate the potential damage that could be caused by malicious attachments:</p>
<ul>
<li>File rewrite &#8211; a number of security solutions on the market are able to convert files into a safe format, for example, rewriting a Microsoft Docx file into a PDF so that no Macros can be executed</li>
<li>Moderator review &#8211; One very effective method of mitigating this threat is to hold all emails from external addresses that contain attachments in a quarantine system until they have undergone administrator review. This will allow them to examine the contents of the emails to determine whether or not they are malicious</li>
<li>Password protected attachments &#8211; As security solutions have no feasible way of decrypting password protected files, there is no way of automatically validating the whether or not their content is malicious. Due to this, it is important to make sure they are either blocked from entering your organisation or, if there is a business requirement for such attachments, at a minimum they should undergo sandboxing or moderator review</li>
</ul>
<h3>Domain names</h3>
<p>A common attack technique used to trick users into providing sensitive information is to use a domain that is close to a company&#8217;s legitimate domain. In order to counter this type of attack, security solutions can be employed to review how similar a sending domain is to the company&#8217;s legitimate domain, blocking emails from all domains that are above a certain level of similarity.</p>
<p>Another attack technique that has been discussed a large amount recently is the use of Internationalised Domain Names (IDN). IDNs are domain names that contain at least one character that is not within the normal ASCII character set. In order to facilitate this, domains can be registered as specially formatted ASCII strings, which are preceded by the characters &#8220;xn--&#8221;. This representation is what is actually registered with domain providers and is called Punycode. Using IDNs, attackers can register domains that look very similar to legitimate sites by changing ASCII characters for Unicode characters (e.g. www.goógle.com could be registered using the Punycode www.xn--gogle-1ta.com). As these IDN domains are actually registered using the Punycode for the domain name, mitigating the threat of this attack technique can be achieved by blocking all domain names that begin with the characters &#8220;xn--&#8221;.</p>
<p>A further way of using a domain to identify malicious activity is to analyse what it appears to be used for. A number of security solutions on the market assign categories to domains, usually based on analysis of the services running on the systems (e.g. the content that is hosted on a web server). Using these solutions, it is also possible to report domains that have been identified as being used in phishing or other malicious activities. As the majority of these solutions operate using a cloud based central server, once a domain has been marked as malicious it will be impractical for attackers to use it in further attacks. Additionally, as attackers are unlikely to want to have their personal details registered to accounts for use in these services, it is likely that they will be unable to have their domains categorised when they set up their phishing. Blocking emails from domains that are not yet categorised can be just as effective at ensuring that phishing attempts do not reach their target.</p>
<h3>Email validation</h3>
<p>The wide range of open source software available to us makes it simple to set up and use a mail server for a domain of our choosing. This, however, provides attackers with the opportunity to send emails as if they were coming from a legitimate site &#8211; name@yourcompanynamehere.com for example. A number of technologies are available that will help to ensure that attackers are not able to spoof emails in this way:</p>
<ul>
<li>Sender Policy Framework (SPF) &#8211; SPF is an email validation system which allows domain administrators to define the hosts that are allowed to send emails for their domain, through the use of a specially formatted DNS TXT record:</li>
</ul>
<div id="attachment_5920" style="width: 310px" class="wp-caption alignnone"><a name="imageclose-5918"><div class="lb-album"><a href="#image-5918"><img src="https://portcullislabs.github.io/wp-content/uploads/2017/07/SPF-300x90.jpg" alt="An example SPF record entry" class="size-medium wp-image-5920"><span></span></a></div>              
<a href="#imageclose-5918" class="css3lightbox-close">
				   <div class="lb-overlay" id="image-5918">
                   <img src="https://portcullislabs.github.io/wp-content/uploads/2017/07/SPF.jpg" alt="image-5918">
                   </div></a><p class="wp-caption-text">An example SPF record entry</p></div>
<ul>
<li>Domain Keys Identified Mail (DKIM) &#8211; DKIM also uses a specially formatted DNS TXT record to validate the sender of an email, through the use of public/private key cryptography. The sending mail server adds a digital signature to outgoing emails, which can be verified using a public key that is published within the DNS record. This email validation method also provides data integrity for the emails, as any alterations made in transit will affect the validation of the digital signature.</li>
</ul>
<div id="attachment_5921" style="width: 310px" class="wp-caption alignnone"><a name="imageclose-5919"><div class="lb-album"><a href="#image-5919"><img src="https://portcullislabs.github.io/wp-content/uploads/2017/07/DKIM-1-300x69.jpg" alt="An example DKIM signature in an email header" class="size-medium wp-image-5921"><span></span></a></div>              
<a href="#imageclose-5919" class="css3lightbox-close">
				   <div class="lb-overlay" id="image-5919">
                   <img src="https://portcullislabs.github.io/wp-content/uploads/2017/07/DKIM-1.jpg" alt="image-5919">
                   </div></a><p class="wp-caption-text">An example DKIM signature in an email header</p></div>
<ul>
<li>Domain-based Message Authentication, Reporting and Conformance (DMARC) &#8211; DMARC takes the 2 validation systems defined above and builds on them to create a much more robust system. It allows domain administrators to define which validation systems are to be used by mail servers for the domain (either SPF, DKIM or both) and how mail servers should handle emails that do not pass the validation process.</li>
</ul>
<p>By utilising these security controls and ensuring that our receiving mail server is checking the DNS records against the information in emails, we are able to ensure that attackers are unable to spoof emails from legitimate domains.</p>
<h3>Malicious email reporting</h3>
<p>If a malicious email does manage to get through all of the security controls at the perimeter, it is likely that at least some of their intended targets will fall for the scam. With that in mind, it is important that users have a method of notifying the people responsible for the security of your organisation that a malicious email has slipped through the net. Multiple solutions for this are available, such as the creation of a plugin for the company mail client or a mailing list that is used to report malicious emails. In tandem to this, policies and procedures should be put into place, which detail the process administrators and security staff should follow to inform employees that there is a phishing attack underway and how to identify it.</p>
<div id="attachment_5922" style="width: 231px" class="wp-caption alignnone"><a name="imageclose-5920"><div class="lb-album"><a href="#image-5920"><img src="https://portcullislabs.github.io/wp-content/uploads/2017/07/DKIM-2.jpg" alt="Mail client plugin" class="size-full wp-image-5922"><span></span></a></div>              
<a href="#imageclose-5920" class="css3lightbox-close">
				   <div class="lb-overlay" id="image-5920">
                   <img src="https://portcullislabs.github.io/wp-content/uploads/2017/07/DKIM-2.jpg" alt="image-5920">
                   </div></a><p class="wp-caption-text">Mail client plugin</p></div>
<h2>Exploitation, installation and command &amp; control</h2>
<p>A number of security controls can be used to mitigate the threat of phishing attacks across the next 3 stages of the cyber kill chain &#8211; Exploitation, Installation and Command &amp; Control. If an attack has managed to progress this far along the cyber kill chain it is imperative that it is identified and stopped to ensure that the attacker is not able to gain a foothold on an internal network.</p>
<h3>End point protection</h3>
<p>The most obvious method of blocking malicious applications from running on a target user&#8217;s system is to install an End Point Protection application. There are a number of options for this on the market, each of them able to detect and protect against millions of variants of malware and other unwanted applications. These products can help to stop an attack at either the Exploitation or Installation stages of the cyber kill chain by identifying and blocking malicious files/activity.</p>
<h3>Outbound proxies</h3>
<p>A common method of attack used in phishing attempts is to provide a link within the email that, when followed, will display a page asking for credentials or other sensitive information. In order to stop attackers using this technique, a network proxy can be used to block traffic to unknown domains. One possible solution to this issue is to only allow access to the top ranked sites, however, for some organisations this may not be practical. In situations such as this, a moderator/administrator should review any unknown domains to ensure that they are not malicious.</p>
<p>In addition to mitigating the threat of users disclosing sensitive information, these solutions can help to break the cyber kill chain at the installation and command &amp; control (C2) stages, by stopping malware from using HTTP connections to unknown domains to download Remote Access Tools (RATs) or as a C2 channel.</p>
<h3>Sandboxing</h3>
<p>Sandboxing is the practice of using a system that is not connected to the live network (usually a virtual machine) to test files for malicious activity. As most attachments used in phishing attacks will have similar behaviour (e.g. connecting back to a command &amp; control node) after being opened, sandboxing can be used to identify them within a safe environment to ensure that no live systems are affected. By using sandboxing technologies we can analyse the behaviour of files against indicators of malicious activity at all three of the stages of the kill chain.</p>
<h2>Threat intelligence</h2>
<p>While having all of the security solutions described above can help to identify and mitigate the threat of phishing attacks, the individuals behind the attacks are always developing and adapting their methodologies. Taking this into account, it is of utmost importance that the indicators of attack that we are looking for evolve with them. By feeding any information gathered from previous attacks into cloud-based threat intelligence platforms, the security community&#8217;s understanding of how attackers are operating will grow, which will in turn improve our ability to stop them.</p>
<h2>Summary</h2>
<p>While the threat of phishing attacks and the damage they can do is significant, both financially and to a company&#8217;s reputation, by looking at the timeline of these attacks it is possible to identify many security controls that can be used to mitigate them. By utilising these controls, through a defence-in-depth approach to security, we are able to limit the number of malicious emails that reach their targeted users. Furthermore, by using information about recognised indicators of attack, we are able to alter the contents of emails to assist users in the identification of emails and content that could potentially cause a security breach.</p>
<p>The post <a href="https://portcullislabs.github.io/blog/a-study-in-scarlet/">A study in scarlet</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://portcullislabs.github.io/blog/a-study-in-scarlet/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>UNIX and Linux setUID advice and guidance</title>
		<link>https://portcullislabs.github.io/blog/unix-and-linux-setuid-advice-and-guidance/</link>
		<comments>https://portcullislabs.github.io/blog/unix-and-linux-setuid-advice-and-guidance/#comments</comments>
		<pubDate>Fri, 16 Jun 2017 14:41:53 +0000</pubDate>
		<dc:creator><![CDATA[AFC]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[AIX]]></category>
		<category><![CDATA[analysis]]></category>
		<category><![CDATA[auditing]]></category>
		<category><![CDATA[blue team]]></category>
		<category><![CDATA[FreeBSD]]></category>
		<category><![CDATA[Linux]]></category>
		<category><![CDATA[root]]></category>
		<category><![CDATA[Solaris]]></category>

		<guid isPermaLink="false">https://portcullislabs.github.io/?p=5793</guid>
		<description><![CDATA[<p>It is a topic that often comes up on client engagements, usually when running structured build reviews of Linux &#8220;gold builds&#8221;, but occasionally when trying to explain in detail how we used a Linux system to pivot internally. SetUID and setGID files are inevitably a risk, potentially allowing attackers to elevate privileges to root from [&#8230;]</p><p>The post <a href="https://portcullislabs.github.io/blog/unix-and-linux-setuid-advice-and-guidance/">UNIX and Linux setUID advice and guidance</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></description>
				<content:encoded><![CDATA[<p>It is a topic that often comes up on client engagements, usually when running structured build reviews of Linux &#8220;gold builds&#8221;, but occasionally when trying to explain in detail how we used a Linux system to pivot internally.</p>
<p>SetUID and setGID files are inevitably a risk, potentially allowing attackers to elevate privileges to root from a basic user. When shared out on SMB or NFS shares they can spread the risk even further.<span id="more-5793"></span></p>
<p>One good approach would be:</p>
<p>&#8220;The only good setUID is a chmod -s setuid&#8221; i.e. deactivate this particular functionality.</p>
<p>However, sysadmins may (understandably) get a bit wobbly when we suggest this and come up with a number of fairly valid reasons why this is tricky. They have a point to some extent, but this is 2017 and we should be biting some of these bullets.</p>
<p>Yes, reducing the risk in this area is tough, but it is in fact a good start in defining least privilege security controls. You can learn how little or how much power individual users require and manage this accordingly. You can also test your changes before rolling them out and sanity check the advice given.</p>
<p>At the very least we need a list of files that should not be setUID that we can give to sysadmins and, with confidence, recommend removing or changing the permissions. A pragmatic strategy for mitigating the risks incurred would also be good.</p>
<h2>So what are they?</h2>
<p>SetUID/setGID bits are file permissions set on binary files when we need them to run with the permissions of the owner (setUID) or the group (setGID) that owns the file, usually a root or equivalent user. Historically this functionality was entrenched in UNIX and Linux and was necessary, up to a point, for a system to function as intended.</p>
<p>Many vendors are now working toward eliminating the requirement for these permissions and UNIX based systems can be configured, with some care, not to use them.</p>
<p>We potentially have 3 categories of setUID and setGID files:</p>
<h3>The &#8220;naughty&#8221; list</h3>
<ul>
<li>May have become setUID by accident, installation of third-party software, malicious activity or sloppy coding and should almost certainly not be allowed</li>
<li>tar, find, vi, etc</li>
<li>Likely high risk to get root easily</li>
<li>Epic fail -rwsrw-rw- More common than you would think</li>
<li>Vendor supplied software often a culprit</li>
</ul>
<h3>The &#8220;remove&#8221; list</h3>
<ul>
<li>Redundant, legacy or not really required to be setUID</li>
<li>rcp, arping, etc</li>
<li>Likely low risk but should be easy to remove</li>
</ul>
<h3>The &#8220;allowed&#8221; list</h3>
<ul>
<li>OS may fail to function as expected if setUID is removed without care</li>
<li>For example passwd, sudo</li>
<li>Should be mitigated to minimise risks</li>
<li>Many can be reclassified as 2 above and have the setUID bit removed</li>
</ul>
<p>We report on categories 1 (naughty) and 2 (remove) scoring appropriate to the risk and ease of exploitation. We report on 3 (allowed) with recommendations to mitigate.</p>
<p>For example, a setUID on the find command (or any shell command with abilities to run other programs or shells) would be a high risk vulnerability allowing regular users to become root fairly easily.</p>
<h2>How to deal with these issues?</h2>
<p>The approach to recommend to customers:</p>
<ol>
<li>Audit &#8211; find all setUID and setGID files on the system locally and on all filesystems not mounted nosetuid</li>
<li>Validate &#8211; elfsign and cross checks against vendor checksums</li>
<li>Eliminate where possible &#8211; uninstall, chmod -s or rm</li>
<li>Mitigate where necessary &#8211; FIM, auditing, remote logging, mount NAS nosetuid</li>
</ol>
<p>This applies primarily to common Linux distributions. Solaris and AIX for example may have slightly different filenames and locations, but similar principles apply.</p>
<p>The ubiquitous sudo or other equivalent tools can be used to configure fine grained privilege management without the requirement for setUID permissions. Your version of sudo must be up to date, the sudoers configuration files must be secure and have a strictly limited set of commands allowed per user or group.</p>
<p>Customers need to consider how the remediation and mitigation steps fit within their overall strategies for user and privilege management alongside local and remote file permissions.</p>
<p>For example:</p>
<p>Do they have a good FIM solution and can they utilise remote logging as a mitigation? Do they wish to work at the standard build level and have a hardened standard build? If so, then maybe they&#8217;re in the right place to look at removing these permissions?</p>
<p>In particular File Integrity Monitoring, which should focus on the most vulnerable files on a system, should track any changes to the files with the setUID/setGID bit set. Any changes should be audited and remotely logged to ensure that an attacker cannot cover their tracks.</p>
<p>Other mitigation techniques include SELinux and other RBAC mechanisms on Linux, Trusted Execution and Trusted Computing Base on AIX and RBAC on Solaris.</p>
<p>More recent Linux kernels (starting 2.6.26) can make use of capabilities which provide fine-grained control over superuser permissions, allowing use of the root user to be avoided.</p>
<p>Sysadmins need some encouragement and support in both remediation and mitigation. If something unexpected does not work upon removing a setUID file permission, it is important to try to use that as a learning experience and a consequence of taking least privilege as far as possible.</p>
<p>At the very least tighten up your sudo configuration and remove as many setUIDs as you can.</p>
<h3>Finding setUID and setGID files</h3>
<pre class="brush: bash; gutter: false; title: ; notranslate">
# find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \;
</pre>
<p>Example output:</p>
<p>Here is a setUID file:</p>
<pre class="brush: bash; gutter: false; title: ; notranslate">
-rws--x--x. 1 root root 23960 Sep 23  2016 /usr/bin/chfn
</pre>
<p>And here is a setGID file:</p>
<pre class="brush: bash; gutter: false; title: ; notranslate">
-r-xr-sr-x. 1 root tty 15392 May  4  2014 /usr/bin/wall
</pre>
<h3>Just for fun</h3>
<p>Snapshot a VM of your favourite Linux distro and run the following command (<b>this will break your system in odd ways, so never do it to a production system</b>) and run the following commands:</p>
<pre class="brush: bash; gutter: false; title: ; notranslate">
# find / -type f -perm -u+s -exec ls -l {} \; |awk '{print $NF}'|grep -v proc &amp;amp;gt; /var/tmp/setUID.lst
# find / -type f -perm -g+s -exec ls -l {} \; |awk '{print $NF}'|grep -v proc &amp;amp;gt; /var/tmp/setGID.lst
# for a in `cat /var/tmp/setUID.lst`; do chmod u-s $a; done
# for a in `cat /var/tmp/setGID.lst`; do chmod g-s $a; done
</pre>
<p>See what breaks.</p>
<p>You can revert to the snapshot if your nerve does not hold.</p>
<p>You should be able to reboot the machine and log in as a normal user. After that you will discover the limitations you have imposed upon yourself and the operating system.</p>
<h3>The lists (mid 2017) which are not exhaustive</h3>
<p>N.B. PATHs to the files may vary&#8230;</p>
<h3>The &#8220;naughty&#8221; list</h3>
<ul>
<li>/usr/bin/awk</li>
<li>/bin/tar</li>
<li>/usr/bin/python</li>
<li>/usr/bin/script</li>
<li>/usr/bin/man</li>
<li>/usr/bin/ssh</li>
<li>/usr/bin/scp</li>
<li>/usr/bin/git</li>
<li>/usr/bin/find</li>
<li>/usr/bin/gdb</li>
<li>/usr/bin/pico</li>
<li>/usr/bin/nano</li>
<li>/usr/bin/zip</li>
<li>/usr/bin/vi</li>
<li>/usr/sbin/lsof</li>
<li>/bin/cat</li>
<li>/usr/bin/vim</li>
<li>/usr/bin/gvim</li>
</ul>
<p>The point with this list is that they should not really be setUID or setGID and they all have command options that could spawn a shell or otherwise engage in mischief.</p>
<h3>The &#8220;remove&#8221; list</h3>
<ul>
<li>/usr/bin/rcp</li>
<li>/usr/bin/rlogin</li>
<li>/usr/bin/rsh</li>
<li>/usr/libexec/openssh/ssh-keysign</li>
<li>/usr/lib/openssh/ssh-keysign</li>
<li>/sbin/netreport</li>
<li>/usr/sbin/usernetctl</li>
<li>/usr/sbin/userisdnctl</li>
<li>/usr/sbin/pppd</li>
<li>/usr/bin/lockfile</li>
<li>/usr/bin/mail-lock</li>
<li>/usr/bin/mail-unlock</li>
<li>/usr/bin/mail-touchlock</li>
<li>/usr/bin/dotlockfile</li>
<li>/usr/bin/arping</li>
<li>/usr/sbin/uuidd</li>
<li>/usr/bin/mtr</li>
<li>/usr/lib/evolution/camel-lock-helper-1.2</li>
<li>/usr/lib/pt_chown</li>
<li>/usr/lib/eject/dmcrypt-get-device</li>
<li>/usr/lib/mc/cons.saver</li>
</ul>
<p>Consider removing as a good mitigation strategy.</p>
<p>Here&#8217;s some others that are usually installed setUID, however, on a hardened system they can usually have their setUID/setGID bits removed:</p>
<ul>
<li>/bin/mount</li>
<li>/bin/umount</li>
<li>/usr/bin/at</li>
<li>/usr/bin/newgrp</li>
<li>/usr/bin/ssh-agent</li>
<li>/sbin/mount.nfs</li>
<li>/sbin/umount.nfs</li>
<li>/sbin/mount.nfs4</li>
<li>/sbin/umount.nfs4</li>
<li>/usr/bin/crontab</li>
<li>/usr/bin/wall</li>
<li>/usr/bin/write</li>
<li>/usr/bin/screen</li>
<li>/usr/bin/mlocate</li>
<li>/usr/bin/chage</li>
<li>/usr/bin/chfn</li>
<li>/usr/bin/chsh</li>
<li>/bin/fusermount</li>
<li>/usr/bin/Xorg</li>
<li>/usr/bin/X</li>
<li>/usr/lib/dbus-1.0/dbus-daemon-launch-helper</li>
<li>/usr/lib/vte/gnome-pty-helper</li>
<li>/usr/lib/libvte9/gnome-pty-helper</li>
<li>/usr/lib/libvte-2.90-9/gnome-pty-helper</li>
</ul>
<h3>The &#8220;allowed&#8221; list</h3>
<ul>
<li>/bin/ping</li>
<li>/bin/su</li>
<li>/sbin/pam_timestamp_check</li>
<li>/sbin/unix_chkpwd</li>
<li>/usr/bin/gpasswd</li>
<li>/usr/bin/locate</li>
<li>/usr/bin/passwd</li>
<li>/usr/libexec/utempter/utempter</li>
<li>/usr/sbin/lockdev</li>
<li>/usr/sbin/sendmail.sendmail</li>
<li>/usr/bin/expiry</li>
<li>/bin/ping6</li>
<li>/usr/bin/traceroute6.iputils</li>
<li>/usr/bin/pkexec</li>
<li>/usr/bin/sudo</li>
<li>/usr/bin/sudoedit</li>
<li>/usr/sbin/postdrop</li>
<li>/usr/sbin/postqueue</li>
<li>/usr/sbin/suexec</li>
<li>/usr/lib/squid/ncsa_auth</li>
<li>/usr/lib/squid/pam_auth</li>
<li>/usr/kerberos/bin/ksu</li>
<li>/usr/sbin/ccreds_validate</li>
</ul>
<h2>Final words</h2>
<p>It&#8217;s worth noting that we know these lists won&#8217;t work for everyone; systems are complex and behaviour is intertwined. That said, no matter what your opinion on the necessity or otherwise of a setUID/setGID bit on a given file, we&#8217;d like to think the approach of knowing which files have the setUID/setGID bit and why is something we can all get on board with.</p>
<h3>Some good references</h3>
<ul>
<li><a title="Understand the setuid and setgid permissions to improve security" href="http://www.techrepublic.com/blog/it-security/understand-the-setuid-and-setgid-permissions-to-improve-security/">Understand the setuid and setgid permissions to improve security</a></li>
<li><a title="Beware of empty paths" href="https://portcullislabs.github.io/blog/beware-of-empty-paths/">Beware of empty paths</a></li>
<li><a title="Exploiting SUID Executables" href="https://www.pentestpartners.com/security-blog/exploiting-suid-executables/">Exploiting SUID Executables</a></li>
<li><a title="Capabilities" href="https://wiki.archlinux.org/index.php/Capabilities">Capabilities &#8211; ArchWiki</a></li>
</ul>
<p>The post <a href="https://portcullislabs.github.io/blog/unix-and-linux-setuid-advice-and-guidance/">UNIX and Linux setUID advice and guidance</a> appeared first on <a href="https://portcullislabs.github.io">Portcullis Labs</a>.</p>]]></content:encoded>
			<wfw:commentRss>https://portcullislabs.github.io/blog/unix-and-linux-setuid-advice-and-guidance/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
	</channel>
</rss>
